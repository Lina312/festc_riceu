C  MANGENEPAWETH 012913
C  MODIFIED December 18,2012 REVISED 
C  ADDED SHREDDER & NEW FERTILIZER TIMING COMPONENT ADDED
C  WINTER WHEAT MULTIPLE DAY PLANT DATE DISTRIBUTION 10 VARIETIES
C  THIS PROGRAM GENERATES MANAGEMENT FILE FOR EPIC AT A 12 KM GRID LEVEL
C  FIRST IT READS AN EPIC SITE FILE LIST TO IDENTIFY THE LOCATION BY LATITUDE AND
C  LONGITUDE AS WELL AS 8-DIGIT HUC, COUNTY AND PRODUCTION REGION TO IDENTIFY THE
C  GIS DATA LINKAGES TO CREATE THE FILE AND TO LOCATE THE THE CLOSEST STATISTICAL 
C  WEATHER STATION DATA

	CHARACTER*2 ASTATE
      CHARACTER*4 AXT,AEXT,ECROP,ECROPA,BLANK1,BXT
	CHARACTER*9 FDATAH,OPSNAME
	CHARACTER*8 COUNTRY,CPROV,BLANK,FTNM,FTNM2012,FNAME,FERTNAME,
     1BASEX
	CHARACTER*12 STATWTHF,STATWTHFM
	CHARACTER*16 BELD4NMX,BELD4NM,BLANK2
      CHARACTER*24 CROPLIST,CROPFERTEST
	CHARACTER*20 WTHSTANAME
	CHARACTER*80 TITLE1WP,TITLE2WP,TITLEFE
	CHARACTER*93 TITLE1,TITLE2
	CHARACTER*232 TITLE1C,TITLE2C
	CHARACTER*207 TITLE1F,TITLE2F

C       Added by UNC, dyang
C       Environment variables used by this management program
        CHARACTER*20   CROPNAME
        CHARACTER*400  SCENDIR, CROPDIR, MANGDIR, WEATDIR, SOILDIR, COMMDIR
        CHARACTER*400  OPCDIR, OUTDIR, EPIC4CMAQ, REGIONDIR, FILENAME
        CHARACTER*2   CROPNUMRF, CROPNUMIR
        LOGICAL      ::XMIS
C       end add by UNC, dyang

	INTEGER*2 SPFLPLT,DRYDOWNDAYS,VARIETY,PREPLTFERTDAYS,FERTEQUIP,
     1PLTEQUIP,BELD4NUM,BELD4NUMX,
     2HARVEQUIPNUM,IRREQUIPNUM,PREPLTTILLNUM,
     3POSTPLTTILL1,POSTPLTTILL2,HARVTILL1,PREPLTTILLTIME,
     4HARVEQUIPNUMX,IRREQUIPNUMX,PREPLTTILLNUMX,
     5POSTPLTTILL1X,POSTPLTTILL2X,HARVTILL1X,PREPLTTILLTIMEX,REG,REGX
C
	INTEGER*2 FERTEQUIPA,PLTEQUIPA,PREPLTFERTDAYSA,SPFLPLTA
	INTEGER*8 RUNNAME,SOILNUMBER,MANAGEMENT,SITENUMBER,EQUIPMENT,
     1IGRIDFERT
	INTEGER*2 IREG,EQUIP,FERTNUM,MANURETYPE,TRACTOR

C       add for EPA for random number generation
        INTEGER, ALLOCATABLE :: IX_seed(:)
C        INTEGER, DIMENSION (2) :: IX_seed
        INTEGER :: randK
        REAL ::    randNum
C       end for EPA

      REAL*8 XLOG12A,YLAT12A,FERTNFRAC
       COMMON/BK2/KR(10),KW(30),KRF(11)
        COMMON/BK3/FERTNFRAC(200),FERTCHAR(10),FERTADJOTHGRASS(60),
     1FERTADJHAYRF(60),FERTADJHAYIR(60)
	COMMON/BK4/FERTNUM(200),EQUIPMENT(200,5),FERTAPPGRID(120000,70)
	COMMON/BK6/AXT(2),BXT(42),BASEX(10),FTNM2012(200)
      COMMON/BK7/IGRID12A,IBELD4CROP,IREG,TRACTOR,MANURETYPE(10)
        COMMON/BK8/IMONEND,IDAYEND,ISFA
C
      DIMENSION EQUIP(5),FERTNAME(200)
	DIMENSION HARVEQUIPNUM(10,70),IRREQUIPNUM(10,70),
     1PREPLTTILLNUM(10,70),POSTPLTTILL1(10,70),POSTPLTTILL2(10,70),
     2HARVTILL1(10,70),PREPLTTILLTIME(10,70),POSTPLTTILL1TIME(10,70),
     3POSTPLTTILL2TIME(10,70),HARVTIME(10,70),
     4REG(10,70),BELD4NM(10,70),BELD4NUM(10,70),
	5NMHUC8(300),NMBELD4(300),NIGRID12KM(300)
      DIMENSION IEPICCRPA(70),ECROPA(70),TOPA(70),TBSA(70),CNYA(70),
     1CPYA(70),WCY(70),IDCA(70),GMHUA(70),PPL1A(70),PPL2A(70),
     2ESTPLTPOPA(70),SPFLPLTA(70),DRYDOWNA(70),IPLTDAYSA(70,10),
	3LUNA(70),PREPLTFERTDAYSA(70),PREPLTFERTFRACA(70),
     4FERTEQUIPA(70),PLTEQUIPA(70),IPLTDAYS(11),
	5FERTP(70),FERTN(70)


      DIMENSION TMAX(12),TMIN(12),NC(12),NCC(13),DLYPHUNC(365),
     1PHUI(365),ADLYPHUNC(365),PHUC(11),DLYPHUCRP(11,365),PHUCX(11),
     2TEMPADJ(50)

      DATA KR/10,11,12,13,14,15,16,17,18,19/KW/20,21,22,23,24,25,26,
     127,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,
     248,49/AXT/'.OPC','.OPC'/BLANK/'        '/BLANK1/'    '/
     3BLANK2/'                '/KRF/50,51,52,53,54,55,56,57,58,59,60/
      DATA TEMPADJ/0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,1,1,
     &1,1,1,1,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0/

C       Added by UNC, dyang
C       Environment variables used by this management program
       print*, "---->> Begin management application run. "
       CALL GETENV( "SCEN_DIR", SCENDIR )
       CALL GETENV( "COMM_DIR", COMMDIR )
       CALL GETENV( "SOIL_DIR", SOILDIR )
       CALL GETENV( "WEAT_DIR", WEATDIR )
       CALL GETENV( "EPIC_CMAQ_OUTPUT", EPIC4CMAQ )
       CALL GETENV( "CROP_NAME", CROPNAME )
       CALL GETENV( "CROP_NUM_RF", CROPNUMRF )
       CALL GETENV( "CROP_NUM_IR", CROPNUMIR )
       CALL GETENV( "MANG_DIR", MANGDIR )
       CROPDIR = TRIM(SCENDIR)//'/'//ADJUSTL(CROPNAME)
C      MANGDIR = TRIM(COMMDIR)//'/util/manageCreate'
       REGIONDIR = TRIM(MANGDIR)//'/regionFert'
       OUTDIR = TRIM(CROPDIR)//'/app/manage'
       OPCDIR = TRIM(OUTDIR)//'/OPC'

       CALL OPENV(61,'SCRATCHTAPE.DAT', OUTDIR, 'W')

       CROPLIST = TRIM(CROPNAME)//'-LIST.DAT' 
       CALL OPENV(KR(9), CROPLIST, CROPDIR, 'R' )
       WRITE(61,*) CROPLIST

       CALL OPENV(KR(2), 'WPM1USLIST.DAT', WEATDIR, 'R' )

       CALL OPENV(KR(5), 'BELD4-EPIC04-10-12.prn', MANGDIR, 'R' )
       CALL OPENV(KR(6), 'BELD4-TILL1-09-12.prn', MANGDIR, 'R' )
       CALL OPENV(KR(7), '2007YieldsNUTRIENTS-ESTrev010912.prn', MANGDIR, 'R' )
       CALL OPENV(KR(8), 'NONRISOIL6TH.DAT', CROPDIR, 'R' )

       CALL OPENV(KW(1),'12kmSITELISTTEST.DAT', OUTDIR, 'W')
       CALL OPENV(KW(2),'WPM1USTEST.DAT', OUTDIR, 'W')
       CALL OPENV(KW(3),'CLOSESTWPM1.DAT', OUTDIR, 'W')
C      OPEN(KW(4),'DISTANCE.DAT')
       CALL OPENV(KW(5),'WETHTEST.DAT', OUTDIR, 'W')
       CALL OPENV(KW(6),'DLYPHUTEST.DAT', OUTDIR, 'W')
       CALL OPENV(KW(7),'HUC8BELD4.DAT', OUTDIR, 'W')
       CALL OPENV(KW(8),'HUC8BELD4EPIC.DAT', OUTDIR, 'W')
       CALL OPENV(KW(9),'PLANTDATEPHU.DAT', OUTDIR, 'W')
       CALL OPENV(KW(10),'PLANTDATE12KM.DAT', OUTDIR, 'W')
       CALL OPENV(KW(11),'PLANTDATE12KMVWB.DAT', OUTDIR, 'W')
        CALL OPENV(KW(12), 'NOVARIETY.DAT', OUTDIR, 'W')
       CALL OPENV(KW(13),'EPICRUNFILE.DAT', OUTDIR, 'W')
       CALL OPENV(KW(15),'OPSNAME.DAT', OUTDIR, 'W')
       CALL OPENV(KW(16),'EPICRUNFILERAIN.DAT', OUTDIR, 'W')
       CALL OPENV(KW(17),'EPICRUNFILEIRR.DAT', OUTDIR, 'W')

C     KW(18) VERIFIES BOTH ('BELD4-EPIC11-15-11.prn') AND
C	('BELD4-TILL110711.prn')
 
        CALL OPENV(KW(18),'BELD4-TILL.DAT', OUTDIR, 'W')
        CALL OPENV(KW(19),'FERTILIZER.DAT', OUTDIR, 'W')
        CALL OPENV(KW(20),'GRIDS_OPC.DAT', OUTDIR, 'W')
        CALL OPENV(KW(21),'NOMATCHVERIFY.DAT', OUTDIR, 'W')
        CALL OPENV(KW(22),'EPICRUNFILEDW.DAT', OUTDIR, 'W')
        CALL OPENV(KW(23),'EPICRUNFILERAINDW.DAT', OUTDIR, 'W')
        CALL OPENV(KW(24),'EPICRUNFILEIRRDW.DAT', OUTDIR, 'W')
        CALL OPENV(KW(25),'TEST.DAT', OUTDIR, 'W')
        CALL OPENV(KW(26),'CROPUNITS-10.DAT', OUTDIR, 'W')
        CALL OPENV(KW(27),'CROPUNITS2-10.DAT', OUTDIR, 'W')
        CALL OPENV(KW(28),'CROPUNITS3-10.DAT', OUTDIR, 'W')
        CALL OPENV(KW(29),'DEBUGPLTD10.DAT', OUTDIR, 'W')
        CALL OPENV(KRF(1),'FERT2012.DAT', MANGDIR, 'R')
        CALL OPENV(KRF(2),'FERTEQUIPBYAPP.PRN', MANGDIR, 'R')
C       CALL OPEN(KRF(3),CROPFERTEST, CROPDIR, 'R')
C       OPEN(KRF(4),FILE='FERT2012.DAT')
        CALL OPENV(KRF(6),'FERTTEST.DAT', OUTDIR, 'W')
        CALL OPENV(KRF(7),'EQUIPTEST.DAT', OUTDIR, 'W')
        CALL OPENV(KRF(8),'FERTAPPTEST.DAT', OUTDIR, 'W')
        CALL OPENV(KRF(9),'SOILLIST.DAT', OUTDIR, 'W')
        CALL OPENV(KRF(10),'IPLTDATE.DAT', OUTDIR, 'W')
        CALL OPENV(KRF(11),'ADJUSTMENTS.DAT', MANGDIR, 'R')

C     READ FERTILIZER TABLE
C  1  FTNM = FERTILIZER NAME
C  2  FN   = MINERAL N FRACTION             FERTCHAR(2)
C  3  FP   = MINERAL P FRACTION             FERTCHAR(3)
C  4  FK   = MINERAL K FRACTION             FERTCHAR(4)
C  5  FNO  = ORGANIC N FRACTION             FERTCHAR(5)
C  6  FPO  = ORGANIC P FRACTION             FERTCHAR(6)
C  7  FNH3 = AMMONIA N FRACTION(FNH3/FN)    FERTCHAR(7)
C  8  FOC  = ORGANIC C FRACTION             FERTCHAR(8)
C  9  FSLT = SALT FRACTION                  FERTCHAR(9)
C 10  FCST = COST OF FERTILIZER($/KG)       FERTCHAR(10)      
  391 READ(KRF(1),395,END=396)I,FTNM,(FERTCHAR(K),K=2,10)
      FERTNFRAC(I)=FERTCHAR(2) + FERTCHAR(5)
	FTNM2012(I)=FTNM
	IX=I
  395 FORMAT(1X,I4,1X,A8,10F8.3)
      GO TO 391
  396 CONTINUE
      DO 392 IFRT=1,IX
	WRITE(KRF(6),393) IFRT,FTNM2012(IFRT),FERTNFRAC(IFRT)
  392 CONTINUE
  393 FORMAT(1X,I4,1X,A8,F8.3)

     	CLOSE (KRF(1))
     	CLOSE (KRF(6))

C     EQUIPMENT USED TO APPLY FERTILIZER BY TIME PERIOD AND FERTILIZER
      READ(KRF(2),403) TITLEFE
	READ(KRF(2),403) TITLEFE
      READ(KRF(2),403) TITLEFE

  403 FORMAT(A80)
C     FNAME=          FERTILIZER NAME
C     FERTNAME(I)=    FERTILIZER NAME ARRAY
C     FERTNUM(I)=     FERTILER NUMBER ARRAY
C     EQUIP(J)=       EQUIPMENT BY TIME PERIOD J ARRAY
C     EQUIPMENT(I,J)= EQUIPMENT BY TIME PERIOD J AND FERTILER I ARRAY
C     TIME PERIODS ARE:
C     1 FOR TOTAL USED TO ESTIMATE MANURE PERCENT APPLIES
C     2 FALL PREPLANT AND FALL PLANT
C     3 SPRING AFTER FALL PLANT
C     4 SPRING PREPLANT AND PLANTF
C     5 POST PLANT AUTOMATIC APPLICATION      
  397 READ(KRF(2),398,END=401) I,FNAME,(EQUIP(J),J=1,5)
      FERTNUM(I)=I
	FERTNAME(I)=FNAME
	IX=I

	DO 399 K=1,5
	EQUIPMENT(IX,K)=EQUIP(K)
  399 CONTINUE
      GO TO 397
  401 CONTINUE
      DO 402 I=1,IX
	WRITE(KRF(7),398) FERTNUM(I),FERTNAME(I),(EQUIPMENT(I,J),J=1,5)
  402 CONTINUE
  398 FORMAT( 1X,I4,1X,A8,5I8)
  
      CLOSE (KRF(2))
     	CLOSE (KRF(7))

C     READ TOTAL NITROGEN APPLIED ESTIMATE FROM SPIN UP 5 YEAR AVERAGE FILE BY CROP
C     5 YEAR AVERAGE FILE NAME IDENTIFIED IN SECOND LINE OF CROPLIST.DAT FILE
      DO 411 I=1,120000
	DO 412 J=1,70
      FERTAPPGRID(I,J) = 0
  412 CONTINUE
  411 CONTINUE

      FILENAME= trim(EPIC4CMAQ)//'/5years/'//trim(CROPNUMRF)//'.csv'
      INQUIRE(FILE=FILENAME,EXIST=XMIS)
      IF (XMIS==.TRUE.) THEN
        OPEN(KRF(3), FILE=TRIM(FILENAME))
        WRITE(*,'(/A/)') 'File '//trim(FILENAME)//' is opened for reading. '
        READ(KRF(3),403,END=405) TITLEFE
  406   READ(KRF(3),404,END=405) IGRIDFERT,ICROP,FERTNAPP
C       write(*,*) IGRIDFERT,ICROP,FERTNAPP
C  404   FORMAT(8X,I6,1X,I2,318X,F8.2)
  404   FORMAT(8X,I6,1X,I2,384X,F11.2)

C     ADDED 10 % ADJUSTMENT FOR RUNOFF LOSS BECAUSE ALL AUTO FNO3 WAS INCORPORATED
C     10 PERCENT BASED ON CEAP REPORT
      FERTAPPGRID(IGRIDFERT,ICROP)=FERTNAPP*1.1

	WRITE(KRF(8),409) IGRIDFERT,ICROP,FERTNAPP
  409 FORMAT(1X,I8,I4,F10.2)
	GO TO 406
      ELSE
        WRITE(*,'(/A/)') 'File '//trim(FILENAME)//' is skipped for reading. '
      END IF
  405 CONTINUE
      CLOSE (KRF(3))

      FILENAME= trim(EPIC4CMAQ)//'/5years/'//trim(CROPNUMIR)//'.csv'
      INQUIRE(FILE=FILENAME,EXIST=XMIS)
      IF (XMIS==.TRUE.) THEN
        OPEN(KRF(3), FILE=TRIM(FILENAME))
        WRITE(*,'(/A/)') 'File '//trim(FILENAME)//' is opened for reading. '
        READ(KRF(3),403,END=415) TITLEFE
  416   READ(KRF(3),404,END=415) IGRIDFERT,ICROP,FERTNAPP
        FERTAPPGRID(IGRIDFERT,ICROP)=FERTNAPP*1.1
        WRITE(KRF(8),409) IGRIDFERT,ICROP,FERTNAPP
  419   FORMAT(1X,I8,I4,F10.2)
        GO TO 416
      ELSE
        WRITE(*,'(/A/)') 'File '//trim(FILENAME)//' is skipped for reading. '
      END IF
  415 CONTINUE
      CLOSE (KRF(3))

      DO 413 I=1,120000
	DO 414 J=1,70
      IF(FERTAPPGRID(I,J)>0) WRITE(KRF(8),408) I,J,FERTAPPGRID(I,J)
  408 FORMAT(1X,I6,1X,I2,F8.2)
  414 CONTINUE
  413 CONTINUE

     	CLOSE (KRF(8))


C     RANDOM NUMBER GENERATOR INITIAL NUMBER FOR PLANT DATE DISTRIBUTION
      IX=1985072130

      call random_seed(size=randK)
      allocate( IX_seed(randK) )

C
C     READ IN BELD4 CROPS BY 8-DIGIT HUC or 12km grid WITH NO SOILS MATCHED
      NM=1
 1014 READ(KR(8),1011,END=1012)NMHUC8(NM),NMBELD4(NM),NIGRID12KM(NM)
      WRITE(KW(21),1111) NM,NMHUC8(NM),NMBELD4(NM),NIGRID12KM(NM)

      NM=NM+1
	GO TO 1014
 1012 CONTINUE
      NMX=NM
C     INITIALIZE VARIABLES
      DO 1103 I=1,10
	DO 1102 J=1,70
      REG(I,J) = 0
	BELD4NM(I,J) = BLANK2
	BELD4NUM(I,J) = 0
	HARVEQUIPNUM(I,J) = 0
      IRREQUIPNUM(I,J) = 0
      PREPLTTILLNUM(I,J) = 0
      POSTPLTTILL1(I,J) = 0
	POSTPLTTILL2(I,J) = 0
      HARVTILL1(I,J) = 0
	PREPLTTILLTIME(I,J) = 0
      POSTPLTTILL1TIME(I,J) = 0
	POSTPLTTILL2TIME(I,J) = 0
      HARVTIME(I,J) = 0
 1102 CONTINUE
 1103 CONTINUE
	DO 1051 IB=1,70
      IEPICCRPA(IB) = 0
	ECROPA(IB) = BLANK1
	TOPA(IB) = 0
	TBSA(IB) = 0
      CNYA(IB) = 0
	CPYA(IB) = 0
	WCY(IB) = 0
	IDCA(IB) = 0
	GMHUA(IB) = 0
	PPL1A(IB) = 0
      PPL2A(IB) = 0
	ESTPLTPOPA(IB) = 0
	SPFLPLTA(IB) = 0
	DRYDOWNA(IB) = 0
      DO 1052 K=1,10
	IPLTDAYSA(IB,K) = 0
 1052 CONTINUE
      LUNA(IB) = 0
	PREPLTFERTDAYSA(IB) = 0
      PREPLTFERTFRACA(IB) = 0
	FERTEQUIPA(IB) = 0
	PLTEQUIPA(IB) = 0
 1051 CONTINUE


C     READ IN TILL NUMBERS AND TIMING BY BELD4 CROP NUMBER
C     REG = REGION NUMBER
C     BELD4NUM = BELD4 CODE NUMBER
C     BELD4NM =BELD4 NAME
C     HARVEQUIPNUM = HARVEST EQUIPMENT NUMBER IN EPIC EQUIPMENT FILE TILLEPA.DAT
C     IRREQUIPNUM = IRRIGATION EQUIPMENT NUMBER IN EPIC EQUIPMENT FILE TILLEPA.DAT
C     PREPLTTILLNUM = PREPLANT TILLAGE EQUIPMENT NUMBER IN EPIC EQUIPMENT FILE TILLEPA.DAT
C     POSTPLTTILL1 = POST PLANT TILLAGE 1 EQUIPMENT NUMBER IN EPIC EQUIPMENT FILE TILLEPA.DAT
C     POSTPLTTILL2 = POST PLANT TILLAGE 2 EQUIPMENT NUMBER IN EPIC EQUIPMENT FILE TILLEPA.DAT
C     HARVTILL1 = TILLAGE AFTER HARVEST EQUIPMENT NUMBER IN EPIC EQUIPMENT FILE TILLEPA.DAT
C     PREPLTTILLTIME = DAYS BEFORE PLANTING WHEN PREPLANT TILLAGE OCCURS
C     POSTPLTTILL1TIME = FRACTION OF HEAT UNITS TO MATURITY WHEN FIRST POST PLANT TILLAGE OCCURS
C     POSTPLTTILL2TIME = FRACTION OF HEAT UNITS TO MATURITY WHEN SECOND POST PLANT TILLAGE OCCURS
C     HARVTIME = FRACTION OF HEAT UNITS TO MATURITY HARVEST OCCURS
C
      READ(KR(6),104)TITLE1
      READ(KR(6),104)TITLE2
      WRITE(KW(18),1044)TITLE1
      WRITE(KW(18),1044)TITLE2
 1001 READ(KR(6),130,END=1002) REGX,BELD4NMX,BELD4NUMX,HARVEQUIPNUMX,
     1IRREQUIPNUMX,PREPLTTILLNUMX,
     2POSTPLTTILL1X,POSTPLTTILL2X,
     3HARVTILL1X,PREPLTTILLTIMEX,
     4POSTPLTTILL1TIMEX,POSTPLTTILL2TIMEX,
     5HARVTIMEX

	BELD4NM(REGX,BELD4NUMX)=BELD4NMX
	BELD4NUM(REGX,BELD4NUMX)=BELD4NUMX
      HARVEQUIPNUM(REGX,BELD4NUMX)=HARVEQUIPNUMX
      IRREQUIPNUM(REGX,BELD4NUMX)=IRREQUIPNUMX
      PREPLTTILLNUM(REGX,BELD4NUMX)=PREPLTTILLNUMX
      POSTPLTTILL1(REGX,BELD4NUMX)=POSTPLTTILL1X
      POSTPLTTILL2(REGX,BELD4NUMX)=POSTPLTTILL2X
      HARVTILL1(REGX,BELD4NUMX)=HARVTILL1X
      PREPLTTILLTIME(REGX,BELD4NUMX)=PREPLTTILLTIMEX
      POSTPLTTILL1TIME(REGX,BELD4NUMX)=POSTPLTTILL1TIMEX
      POSTPLTTILL2TIME(REGX,BELD4NUMX)=POSTPLTTILL2TIMEX
      HARVTIME(REGX,BELD4NUMX)=HARVTIMEX
	REG(REGX,BELD4NUMX) = REGX


	GO TO 1001
 1002 CONTINUE
      DO 1101 I=1,10
	DO 1100 J=22,63
      WRITE(KW(18),130) REG(I,J),BELD4NM(I,J),BELD4NUM(I,J),
	1HARVEQUIPNUM(I,J),
     2IRREQUIPNUM(I,J),PREPLTTILLNUM(I,J),
     3POSTPLTTILL1(I,J),POSTPLTTILL2(I,J),
     4HARVTILL1(I,J),PREPLTTILLTIME(I,J),
     5POSTPLTTILL1TIME(I,J),POSTPLTTILL2TIME(I,J),
     6HARVTIME(I,J)
 1100 CONTINUE
 1101 CONTINUE
C     KILL TILLAGE NUMBER IS 451
      KILL = 451

C     READ "BELD4-EPIC04-10-12.PRN" MANAGEMENT INFORMATION
C     CROSS REFERENCE BELD4 NUMBER WITH APPROPRIATE EPIC CROP NUMBER AND 
C     READ CROP DATA NECESSARY TO ESTIMATE PLANT DATE AND HEAT UNITS TO MATURITY
C     THE LETTER A IS ADDED TO EACH VARIABLE NAME TO CREATE THE ARRAY NAME
C     IBELD4 = BELD4 CROP CODE
C     IEPICCRP = EPIC CROP CODE
C     ECROP = EPIC CROP 4-CHARACTER NAME
C     TOP = OPTIMAL CROP TEMPERATURE
C     TBS = BASE TEMPERATURE WHEN GROP GROWS
C     CNY = NITROGEN CONCENTRATION IN CROP YIELD
C     CPY = PHOSPHORUS CONCENTRATION IN CROP YIELD
C     WCY = WATER CONCENTRATION IN CROP YIELD
C     IDC = EPIC CROP CHARATERISTICS
C     GMHU = HEAT UNIT COLLECTED BEFORE GERMINATION
C     PPL1 = POINT ONE ON PLANT POPULATION CURVE IN EPIC
C     PPL2 = POINT TWO ON PLANT POPULATION CURVE IN EPIC
C     ESTPLTPOP = ESTIMATED AVERAGE PLANT POPULATION EAST OF 100TH MERIDAN
C     SPFLPLT = SPRING FALL PLANTING CODE WHERE SPRING=1 AND FALL=2
C     DRYDOWN = PLANNED CROP DRYDOWN FRACTION OF HEAT UNITS TO MATURITY
C     IPLTDAYS(K),K=1,5 = FIVE ALTERNATIVE VARIETY NUMBER OF DAYS TO MATURITY
C     LUN = SCS LAND USE CURVE NUMBER GROUP
C     PREPLTFERTDAYS = DAYS BEFORE PLANTING THAT FERTILIZER IS APPLIED
C     PREPLTFERTFRAC = FRACTION OF FERTILIZER N APPLIED PREPLANT
C     FERTEQUIP = FERTILIZER APPLICATION EQUIPMENT NUMBER
C     PLTEQUIP = PLANTER EUIPMENT NUMBER
C
C     READ "BELD4-EPIC04-10-12.PRN" MANAGEMENT INFORMATION

      READ(KR(5),1040)TITLE1C
      READ(KR(5),1040)TITLE2C
   14 READ(KR(5),109,END=15)IBELD4,IEPICCRP,ECROP,TOP,TBS,CNY,CPY,WCYA,
     1IDC,GMHU,PPL1,PPL2,ESTPLTPOP,SPFLPLT,DRYDOWN,(IPLTDAYS(K),K=1,10),
	2LUN,PREPLTFERTDAYS,PREPLTFERTFRAC,FERTEQUIP,PLTEQUIP
C
C     SET UP EPIC CROP INFORMATION ARRAYS FOR BELD4 CROPS
C
      IEPICCRPA(IBELD4)=IEPICCRP
	ECROPA(IBELD4)=ECROP
	TOPA(IBELD4)=TOP
	TBSA(IBELD4)=TBS
	CNYA(IBELD4)=CNY
	CPYA(IBELD4)=CPY
	WCY(IBELD4)=WCYA
	IDCA(IBELD4)=IDC
	GMHUA(IBELD4)=GMHU
	PPL1A(IBELD4)=PPL1
	PPL2A(IBELD4)=PPL2
	ESTPLTPOPA(IBELD4)=ESTPLTPOP
	SPFLPLTA(IBELD4)=SPFLPLT
	DRYDOWNA(IBELD4)=DRYDOWN
	DO 1114 K=1,10
	IPLTDAYSA(IBELD4,K)=IPLTDAYS(K)
 1114 CONTINUE
	LUNA(IBELD4)=LUN
	PREPLTFERTDAYSA(IBELD4)=PREPLTFERTDAYS
	PREPLTFERTFRACA(IBELD4)=PREPLTFERTFRAC
	FERTEQUIPA(IBELD4)=FERTEQUIP
	PLTEQUIPA(IBELD4)=PLTEQUIP
	GO TO 14
   15 CONTINUE
      WRITE(KW(18),1040)TITLE1C
      WRITE(KW(18),1040)TITLE2C
	DO 1050 IB=22,63
      WRITE(KW(18),109)IB,IEPICCRPA(IB),ECROPA(IB),TOPA(IB),TBSA(IB),
     1CNYA(IB),CPYA(IB),WCY(IB),IDCA(IB),GMHUA(IB),PPL1A(IB),
     2PPL2A(IB),ESTPLTPOPA(IB),SPFLPLTA(IB),DRYDOWNA(IB),
     3(IPLTDAYSA(IB,K),K=1,10),LUNA(IB),PREPLTFERTDAYSA(IB),
     4PREPLTFERTFRACA(IB),FERTEQUIPA(IB),PLTEQUIPA(IB)
 1050 CONTINUE
	DO 1053 IB=67,70
      WRITE(KW(18),109)IB,IEPICCRPA(IB),ECROPA(IB),TOPA(IB),TBSA(IB),
     1CNYA(IB),CPYA(IB),WCY(IB),IDCA(IB),GMHUA(IB),PPL1A(IB),
     2PPL2A(IB),ESTPLTPOPA(IB),SPFLPLTA(IB),DRYDOWNA(IB),
     3(IPLTDAYSA(IB,K),K=1,10),LUNA(IB),PREPLTFERTDAYSA(IB),
     4PREPLTFERTFRACA(IB),FERTEQUIPA(IB),PLTEQUIPA(IB)
 1053 CONTINUE

C     NUTRIENT NEEDS ESTIMATES BASED ON 2007 AG CENSUS AND EPIC CROP PARAMETERS AND
C     VWB JUDGEMENT
C     BELD4NUM = BELD4 CODE NUMBER
C     FERTN(BELD4NUM) = ESTIMATED NITROGEN FERTILIZER TO REPLACE CROP REMOVAL
C     FERTP(BELD4NUM) = ESTIMATED PHOSPHORUS NITROGEN FERTILIZER TO REPLACE CROP REMOVAL


      READ(KR(7),1049)TITLE1F
      READ(KR(7),1049)TITLE2F
 1003 READ(KR(7),131,END=1004) IBELD4,FERTNX,FERTPX
C    INITIAL FERTILIZER N SET TO 1 FOR SPIN UP ONLY
C      FERTN(IBELD4) = FERTNX
      FERTN(IBELD4) = 3     
      FERTP(IBELD4) = FERTPX

      WRITE(KW(19),131) IBELD4,FERTN(IBELD4),FERTP(IBELD4)
	GO TO 1003
  131 FORMAT(2X,I6,44X,2F8.0)
 1049 FORMAT(A207)      
 1004 CONTINUE
C     READ IN FERTILIZER ADJUSTMENT FACTORS FOR HAY AND OTHER GRASS
  569 READ(KRF(11),568,END=567) ISFA,FERTADJHAYRF(ISFA),
     1FERTADJHAYIR(ISFA),FERTADJOTHGRASS(ISFA)
C     write(*,*) ISFA,FERTADJHAYRF(ISFA),FERTADJOTHGRASS(ISFA)
      GO TO 569
  567 CONTINUE
  568 FORMAT(1X,I2,3F5.2)



C     READ DESCRIPTIVE DATA BY CROP FOR ALL 12KM SITES
C     READS ALL RECORDS IN CROPLIST AND THEN START MANAGEMENT FILE CREATION
C     FOR EACH RECORD IN THE CROPLIST BY 12-KM GRID
C	IGRID12A = 12KM GRID NUMBER 
C     XLOG12A = LONGITUDE OF 12KM GRID
C     YLAT12A = LATITUDE OF 12KM GRID
C     ELEV12A = ELEVATION OF 12KM GRID IN FEET
C     SLGRID12A = PERCENT SLOPE OF 12KM GRID
C     IHUC8 = 8-DIGIT HUC NUMBER
C     IREG = PRODUCTION REGION NUMBER (1-10)
C     IFIPS = CENSUS STATE AND COUNTY CODE
C     CROP = PERCENT OF 12KM GRID IN CROPS
C     GRASS = PERCENT OF 12KM GRID IN GRASS
C     AG = TOTAL PERCENT AGRICULTURAL LAND
C     COUNTRY = COUNTRY ABBREVIATION
C     CPROV = COUNTRY-PROVINCE ABBREVIATION
    9 READ(KR(9),100,END=777)IGRID12A,IBELD4CROP,XLOG12A,YLAT12A,
     1ELEV12A,SLGRID12A,IHUC8,IREG,IFIPS,CROP,GRASS,AG,COUNTRY,CPROV
C      write (*,*)IGRID12A,IBELD4CROP,XLOG12A,YLAT12A,
C     1ELEV12A,SLGRID12A,IHUC8,IREG,IFIPS,CROP,GRASS,AG,COUNTRY,CPROV
	ELEV12A = ELEV12A
	ISTATE=IFIPS/1000

C     added for EPA on scenario comparison by using constant random number
C      IX_CROP = IGRID12A * 10000 + IBELD4CROP

      IX_seed(1) = IGRID12A*10000
      DO 1200 K=2,randK
        IX_seed(K) = IBELD4CROP*10000
 1200 CONTINUE


C      write(*,*)
C      write(*,*)  "IGRID12A=",IGRID12A," IBELD4CROP=",IBELD4CROP," randK=",randK

      WRITE(KW(1),100)IGRID12A,IBELD4CROP,XLOG12A,YLAT12A,ELEV12A,
     1SLGRID12A,IHUC8,IREG,IFIPS,CROP,GRASS,AG,COUNTRY,CPROV
	WRITE(61,7100) IREG
 7100 FORMAT(1X,I4)
C     FIND CLOSEST WEATHER STATION
C     CLT = DEGREES PER RADIAN
      DATA CLT/57.296/PIT/58.13/

C     READ IN DESCRIPTIVE DATA FOR ALL EPIC WEATHER STATIONS
C     NUMBER = EPIC SEQUENCE NUMBER FOR WEATHER STATION
C     STATWTHF = WEATHER STATION FILE NAME
C     WLAT = WEATHER STATION LATITUDE
C     WLONG = WEATHER STATION LONGITUDE
C     ASTATE = 2-LETTER STATE ABBREVIATION
C     WTHSTANAME = ABBREVIATED WEATHER STATION NAME
C     ELEV = WEATHER STATION ELVATION
C     REMOVED STATION 608 DUPLICATE NAME OF 606 NVELKO
      D=10000000000
    2 READ(KR(2),101,END=3)NUMBER,STATWTHF,WLAT,WLONG,ASTATE,WTHSTANAME,
     1ELEV
C      WRITE(KW(2),101)NUMBER,STATWTHF,WLAT,WLONG,ASTATE,WTHSTANAME,ELEV
  101 FORMAT(1X,I4,1X,A12,2F8.2,3X,A2,1X,A20,20X,F10.2)

C     THIS ROUTINE CALCULATES DISTANCE BETWEEN TWO POINTS ON THE EARTH 
C	YLATM = LATITUDE OF CLOSEST WEATHER STATION
C	XLOXM = LONGITUDE OF CLOSEST WEATHER STATION
C	NUMBERM = EPIC NUMBER OF CLOSEST WEATHER STATION
C	STATWTHFM =CLOSEST WEATHER STATION FILENAME OF 
C	DM = DISTANCE BETWEEN SITE LAT&LONG AND WEATHER STATION LAT&LONG
C     CLOSEST WEATHER STATION DISTANCE MAY BE ADJUSTED IF THE SITE ELEVATION AND
C     WEATHER STATION ELEVATION ARE SIGNIFICANTLY DIFFERENT
C     EQUATION FOR ADJUSTMENT FOLLOWS DISTANCE CALCULATION BELOW 

	XLOX=ABS(XLOG12A)
	YLAT=YLAT12A
	RYT1=YLAT/CLT
	RXG1=XLOX/CLT
	C1=COS(RYT1)
	S1=SIN(RYT1)
	X=ABS(WLONG)
	Y=WLAT
	RY=Y/CLT
	RX=X/CLT
	RXCORR=0
	RXDIF=ABS(RX-RXG1)
	IF(RXDIF.LT.0.001) RXDIF=0.001
	DX=3963.*1.609*ACOS(S1*SIN(RY)+C1*COS(RY)*COS(RXDIF))
C     ELEVATION ADDED TO WEATHER STATION SELECTION
      ELEVDIFF=ABS(ELEV-ELEV12A)
C     VEREL'S EQUATION FOR ELEVATION ADDED TO WEATHER STATION SELECTION
C	DXELEV = DX + ELEVDIFF/10
C     JIMMY'S EQUATION FOR ELEVATION ADDED TO WEATHER STATION SELECTION
      DXELEV = 0.9*DX + 0.1*ELEVDIFF
C	WRITE(KW(4),103) DX,ELEVDIFF,DXELEV
  103 FORMAT(1X,3F10.2)
      IF(DXELEV>D)GO TO 2
      D=DXELEV
	YLATM=WLAT
	XLOXM=WLONG
	NUMBERM=NUMBER
	STATWTHFM=STATWTHF
	ELEVSTAT=ELEV
	DM=D 
	DXELEVM=DXELEV
      GO TO 2
    3 CONTINUE

C     THE WEATHER LIST IS REWOUND AFTER EACH SITE/WEATHER STATION MATCH
      REWIND KR(2)
      WRITE(KW(3),102) NUMBERM,STATWTHFM,YLATM,XLOXM,DM,IGRID12A,
     1XLOG12A,YLAT12A,ELEV12A,SLGRID12A,IHUC8,IREG,IFIPS,
     2CROP,GRASS,AG,COUNTRY,CPROV,ELEV12A,ELEVSTAT,DXELEVM

C      CREATE HEAT UNIT MANAGEMENT SCHEDULE
C      READ IN MONTHLY TEMPERATURE FOR CLOSEST STATION

      CALL OPENV(KR(3),STATWTHFM, WEATDIR, 'R')
      READ(KR(3),174)TITLE1WP
      READ(KR(3),174)TITLE2WP
      READ(KR(3),105)(TMAX(J),J=1,12)
      READ(KR(3),105)(TMIN(J),J=1,12)
	REWIND KR(3)
	WRITE(KW(5),105)(TMAX(J),J=1,12)
      WRITE(KW(5),105)(TMIN(J),J=1,12)

C     DAYS BY MONTH AND CUMMULATIVE DAYS BY MONTH
      DATA NC /31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31/
     1NCC /0, 31, 59, 90, 120, 151, 181, 212, 243, 273,304, 334, 365/
C     CALCULATE HEAT UNITS PER DAY BASE 0 DEGREES CELSIUS
C     JULD = JULIAN DAY OF YEAR
C     PHUNC = HEAT UNITS BASE 0 C. EACH DAY
C     DLYPHUNC = HEAT UNITS BASE 0 C. EACH JULIAN DAY
C     ADLYPHUNC = ACCUMULATED HEAT UNITS BASE 0 C. EACH JULIAN DAY
C     SUMPHUNC = ACCUMULATED HEAT UNITS BASE 0 C. FOR YEAR
C     PHUI = HEAT UNIT INDEX (ACCUMULATED FRACTION OF YEAR) BASE 0 C. FOR EACH JULIAN DAY
      SUMPHUNC = 0
      DO 8 JULD = 1, 365
	ADLYPHUNC(JULD) = 0
	DLYPHUNC(JULD) = 0
    8 CONTINUE
      JULD=0
C       IFALLFERTDAY=0
      DO 5 J=1,12
	DO 6 JD=1,NC(J)
	JULD=JD + NCC(J)
      PHUNC = (TMAX(J)+TMIN(J))/2
	IF(PHUNC.LT.0.0) PHUNC = 0.0
C       IF(IFALLFERTDAY>0)GO TO 5501
C       IF(J>8.AND.PHUNC==0.0) IMONEND=J
C       IF(J>8.AND.PHUNC==0.0) IDAYEND=JD
C      IFALLFERTDAY=1
 5501   DLYPHUNC(JULD) = PHUNC
	JULDX=1
	IF(JULD.GT.1) JULDX=JULD-1
	ADLYPHUNC(JULD) = ADLYPHUNC(JULDX) + PHUNC
      SUMPHUNC = SUMPHUNC + PHUNC
    6 CONTINUE
    5 CONTINUE
      DO 7 JULD = 1,365
      PHUI(JULD) = ADLYPHUNC(JULD)/SUMPHUNC
	WRITE(KW(6),106) JULD,DLYPHUNC(JULD),SUMPHUNC,ADLYPHUNC(JULD),
     1PHUI(JULD)
    7 CONTINUE

C     CALCULATE PLANT DATE AND HEAT UNIT FOR SELECTED CROP
C     SET VARIETY DAY TO MATURITY FOR CROP BY 12KM GRID
      DO 830 IV=1,11
	IPLTDAYS(IV)=0
  830 CONTINUE
C     IPLTDAYS(11) IS TOTAL DAYS IN THE YEAR
      IPLTDAYS(11) = 365
      IBELD4=IBELD4CROP
      IBELD4X=IBELD4CROP
C     BELD4 #67 IS FOR RAINFED HAY BELOW 35 DEGREES LATITUDE
C     BELD4 #68 IS FOR IRRIGATED HAY BELOW 35 DEGREES LATITUDE
C     BELD4 #69 IS FOR RAINFED OTHER GRASS BELOW 35 DEGREES LATITUDE
C     BELD4 #70 IS FOR IRRIGATED OTHER GRASS BELOW 35 DEGREES LATITUDE
   16 IF(IBELD4.EQ.26) GO TO 19
      IF(IBELD4.EQ.27) GO TO 24
      IF(IBELD4.EQ.22) GO TO 22
	IF(IBELD4.EQ.23) GO TO 27
      GO TO 18
C     BELD4 OTHER GRASS ABOVE 35 DEGREES LATITUDE OR ABOVE 1500 METERS 
C     ELEVATION IS ASSUMED TO BE FESCUE AND
C     BELOW 35 DEGREES LATITUDE IT IS ASSUMED TO BE BERMUDA GRASS BELOW 1500 
C     METERS ELEVATION
   19 IF(YLAT12A.LT.35.0000.AND.ELEV12A.LT.1500)IBELD4 = 69
      GO TO 18
   24 IF(YLAT12A.LT.35.0000.AND.ELEV12A.LT.1500)IBELD4 = 70
      GO TO 18
C     BELD4 HAY ABOVE 35 DEGREES LATITUDE OR ABOVE 1500 METERS 
C     ELEVATION IS ASSUMED TO BE FESCUE OR WEST OF -98 DEGREES LONGITUDE 
C     BELOW 35 DEGREES LATITUDE IT IS ASSUMED TO BE BERMUDA GRASS BELOW 1500 
C     METERS ELEVATION AND EAST OF -98 DEGREES LONGITUDE
C   22 IF(YLAT12A.LT.35.0000.AND.ELEV12A.LT.1500.AND.XLOG12A.GT.(-98.))     
C     1IBELD4 = 67
C
   22 IF(YLAT12A.LT.35.0000.AND.ELEV12A.LT.1500.)IBELD4 = 67
      GO TO 18
C   27 IF(YLAT12A.LT.35.0000.AND.ELEV12A.LT.1500.AND.XLOG12A.GT.(-98.))
C     1IBELD4 = 68

   27 IF(YLAT12A.LT.35.0000.AND.ELEV12A.LT.1500.)IBELD4 = 68

   18 CONTINUE
      DO 31 IV=1,10
	IPLTDAYS(IV)=IPLTDAYSA(IBELD4,IV)
   31 CONTINUE
      IEPICCRP=IEPICCRPA(IBELD4)
	ECROP=ECROPA(IBELD4)
	TOP=TOPA(IBELD4)
	TBS=TBSA(IBELD4)
	CNY=CNYA(IBELD4)
	CPY=CPYA(IBELD4)
	WCYA=WCY(IBELD4)
	IDC=IDCA(IBELD4)
	GMHUA=GMHUA(IBELD4)
	PPL1=PPL1A(IBELD4)
	PPL2=PPL2A(IBELD4)
	ESTPLTPOP=ESTPLTPOPA(IBELD4)
	SPFLPLT=SPFLPLTA(IBELD4)
	DRYDOWN=DRYDOWNA(IBELD4)
	LUN=LUNA(IBELD4)
	PREPLTFERTDAYS=PREPLTFERTDAYSA(IBELD4)
	PREPLTFERTFRAC=PREPLTFERTFRACA(IBELD4)
	FERTEQUIP=FERTEQUIPA(IBELD4)
	PLTEQUIP=PLTEQUIPA(IBELD4)

      IAUI = 500

     
      IPLTDATE=0
	IMATD = 0
C INITIALIZE VARIABLES FOR UP TO 10 PLANT VARIETIES 
C     ESTIMATE PLANT DATE
	DO 203 IV=1,11
	IJULD=0
	IPLTDATE = 0
	DO 200 IM=1,12
	DO 201 ID=1, NC(IM)
      IJULD=IJULD + 1
C     PLANTDATE CODE BASED ON MINIMUM TEMPERATURE, DAYLENGTH, AND RADIATION
C     XX IS LATITUDE IN RADIANS
	XX=YLAT12A/CLT
      YLS=SIN(XX)
      YLC=COS(XX)
      YTN=TAN(XX)
C     THE FOLLOWING EQUATION CAME FROM EPIC0509 SUBROUTINE WHLRMX
C     THIS SUBPROGRAM COMPUTES DAY LENGTH & MAX SOLAR RADIATION AT THE
C     EARTHS SURFACE.
      XI=IJULD
      SD=.4102*SIN((XI-80.25)/PIT)
      CH=-YTN*TAN(SD)
      IF(CH.GE.1.)GO TO 57
      IF(CH.LE.-1.)GO TO 58
      H=ACOS(CH)
      GO TO 59
   57 H=0.
      GO TO 59
   58 H=3.1416
   59 DD=1.+.0335*SIN((XI+88.2)/PIT)
      HRLT=7.72*H
C     HRLT IS HOUR OF LIGHT AND RAMX IS MAIMUM DAILY RADIATION
      HR0=HRLT
      RAMX=30.*DD*(H*YLS*SIN(SD)+YLC*COS(SD)*SIN(H))
C     ROUTINE TO ESTIMATE DAILY MINIMUM TEMPERATURE FROM MONTHLY MEAN MINIMUM

      IF(IM==1) DAILYTEMPINCREASE = (TMIN(12)-TMIN(1))/(NC(IM))
	IF(IM>1)DAILYTEMPINCREASE = (TMIN(IM)-TMIN(IM-1))/(NC(IM))
	IF(IM==1)FIRSTDAY =TMIN(12)+ ((NC(IM)/2)*DAILYTEMPINCREASE)
	IF(IM>1)FIRSTDAY =TMIN(IM-1)+ ((NC(IM)/2)*DAILYTEMPINCREASE)
C     THRESHOLD IS A TEMPERATURE AT WHICH THE FARMER WOULD LIKELY PLANT 
C     IN AN AVERAGE YEAR WITH ADJUSTMENTS FOR DAY LENGHT AND RADIATION
	THRESHOLD = (FIRSTDAY + DAILYTEMPINCREASE * ID)
C     ADJUSTMENT FOR DAY LENGTH, RADIATION ADJUSTMENT NOT ACTIVE
	IF(YLAT12A>40) THRESHOLD=THRESHOLD*((HRLT**1.0)/(12**1.0))
C     &*(RAMX/27.0)
C     FARMER TARGET TEMPERATURE FOR PLANTING
	IBCRP=IBELD4 -21
C     TEMPADJ IS AN ADJUSTMENT TO CROP BASE TEMPERATURE TO ENHANCE PLANT DATE FIT
C     TO USDA AVERAGE DATA, CROP BASE TEMPERATURE COULD VARY WITH VARIETY
      FTTEMP=TBS+TEMPADJ(IBCRP)
      IF(THRESHOLD>FTTEMP) GO TO 205
	GO TO 201
  205 CONTINUE
C     SOYBEAN DAY LENGTH RESTRICTION ON PLANTING DATE BELOW 38 DEGREES LATITUDE
C     USE DIFFERENT VARIETY DAYS TO MATURITY BY REGION FOR SOYBEAN TO REFLECT 
C     SENSITIVTY TO DAY LENGTH AS WELL AS TEMPERATURE
      IVAR=1
      GO TO(80,80,80,80,80,80,80,80,80,80,84,84,80,80,80,80,80,80,80,80,
     180,80,80,80,80,80,80,80,80,80,884,884,80,80,80,80,84,84,80,80,80,
     280,80,80,80,80,80,80,80),IBCRP
  884 GO TO(885,886,887,888,889,890,891,892,893,894),IREG
  885 IVAR=4
      GO TO 80
  886 IVAR=4
      GO TO 80
  887 IVAR=5
      GO TO 80
  888 IVAR=6
      GO TO 80
  889 IVAR=6
      GO TO 80
  890 IVAR=4
      GO TO 80
  891 IVAR=6
      GO TO 80
  892 IVAR=4
      GO TO 80
  893 IVAR=6
      GO TO 80
  894 IVAR=1
      GO TO 80
   84 IVAR =3
   80 IPLTDATE =IJULD
C     LET PLANT DATE RANGE FROM 10 DAYS IN THE NORTHERN U.S. UP 30 DAYS AS
C     LATITUDES DECREASE 
      PLTRANGE=(60.-YLAT12A)

C     IDAHO IS TREATED MORE LIKE CALIFORNIA BECAUSE MOST CROPLAND IS IN SOTHERN IDAHO
      IF(IFIPS>16000.AND.IFIPS<17000) IVAR=1

      GO TO 783
C   81 IVAR=5
C      IF(YLAT12A>37.999999) IPLTDATE =IJULD
C      IF(YLAT12A<38.) IPLTDATE=YLAT12A*3.
C      IPLTDATE= 130-(50-YLAT12A)
C      IF(YLAT12A<31.) IPLTDATE=IPLTDATE-((32-YLAT12A)*3)
C
C      PLTRANGE=(60.-YLAT12A)*1.5
C
C	GO TO 783
  201 CONTINUE
  200 CONTINUE
  203 CONTINUE
  783 CONTINUE
C  	WRITE(KW(29),1206)IBCRP,IGRID12A,IPLTDATE,
C     &(IPLTDAYS(JIV),JIV=1,11),IMATD,
C     &XLOG12A,YLAT12A,THRESHOLD,TBS,RAMX,HRLT,NUMBERM,STATWTHFM,
C     &TMIN(IM),TMIN(IM-1),DAILYTEMPINCREASE
 1206 FORMAT(1X,I2,I10,I5,12I5,6F8.2,I4,2X,A12,3F8.2) 


C      WRITE(KW(29),1205) IBCRP,IGRID12A,IPLTDATE,
C     &(IPLTDAYS(JIV),JIV=1,11),IMATD,
C     &XLOG12A,YLAT12A,THRESHOLD,TBS,RAMX,HRLT,NUMBERM,STATWTHFM,YLATM,
C     &XLOXM,DM,IGRID12A,XLOG12A,YLAT12A,ELEV12A,SLGRID12A,IHUC8,IREG,
C     &IFIPS,CROP,GRASS,AG,COUNTRY,CPROV,ELEV12A,ELEVSTAT,DXELEVM
 1205 FORMAT(1X,I2,I10,I5,12I5,6F8.2,I4,2X,A12,2F8.2,F10.2,1X,I8,1X,
     12F10.4,2X,F7.1,F7.4,2X,I10,2X,I2,2X,I5,3(2X,F7.3),2A8,3F10.2) 

C     PLANT DATE VARIABLE DAY DISTRIBUTION

C     modified for EPA scenario comparison
C               IX = IX_CROP
C		CALL DAGEN(IX,IDA,PLTRANGE)

      CALL RANDOM_SEED (PUT=IX_seed)
      CALL RANDOM_NUMBER (randNum)
      IDA = int(randNum * PLTRANGE) + 1

	WRITE(KRF(10),77777) IPLTDATE
77777	FORMAT(5I4)
      IPLTDATE = IPLTDATE + IDA

C      write(*,*) "1 IPLTDATE=",IPLTDATE,"IDA=",IDA,"PLTRANGE=",PLTRANGE,"IX_CROP=",IX_CROP

	IPLTDATEADJ=IPLTDATE
	WRITE(KRF(10),77777) IPLTDATE,IPLTDATEADJ
 
	IF(IPLTDATE<4) IPLTDATE=4
      IPLTDATEADJ3=IPLTDATE
	WRITE(KRF(10),77777) IPLTDATE,IPLTDATEADJ,IPLTDATEADJ3

C     PLANT DATE ADJUSTMENT FOR ALFALFA, FESUE AND BERMUDA GRASS
C      IF(IBELD4==22.OR.IBELD4==23.OR.IBELD4==26.OR.IBELD4==27.OR.
C	1IBELD4==67.OR.IBELD4==68.OR.IBELD4==24.OR.IBELD4==25) 
C     2IPLTDATE = IPLTDATE + 50
C      IPLTDATEADJ350=IPLTDATE
C	WRITE(KRF(10),77777) IPLTDATE,IPLTDATEADJ,IPLTDATEADJ3,IPLTDATEADJ350

C     CALCULATE HEAT UNITS AND DETERMINE PLANT DATE THAT REACHES HEAT UNITS DEFINED 
C     TO PLANT CROP BY LATITUDE
      DO 202 IV=1,11
	PHUC(IV)=0
      DO 210 IJD = 1,365
  	DLYPHUCRP(IV,IJD) = 0
  210 CONTINUE
  202 CONTINUE
      IVARB=IVAR
C     ADJUSTMENT FOR COTTON
	IF(IBCRP==35.OR.IBCRP==36) GO TO 8888
  	IF(YLAT12A<31.0) IVARB=1
 8888	DO 784 IV=1,11
	PHUCX(IV) = 0
	IJULD=0
	IMATD=0
	DO 785 IM=1,12
	DO 786 ID=1, NC(IM)
      IJULD=IJULD + 1
      IF(IPLTDAYS(IV).EQ.0.0) GO TO 784
	IF(IJULD<IPLTDATE) GO TO 786
C     DLYPHU IS HEAT UNITS ABOVE THE BASE TEMPERATURE OF THE CROP FOR SCHEDULING 
C     AFTER PLANT
	DLYPHU= ((TMAX(IM)+TMIN(IM))/2)- TBS
	IF(DLYPHU.LT.0.001) GO TO 786
      IF(IV.EQ.11) GO TO 211
	GO TO 212
C     CALCULATE ACCUMULATIVE HEAT UNITS BY DAY FROM PLANT DATE UNTILL NO MORE ARE
C     ACCUMLATED I.E. AVERAGE TEMPERATURE BELOW BASE TEMPERATURE OF CROP
  211 IJDX= IJULD-1
      IF(IJDX.GT.0) DLYPHUCRP(IV,IJULD) = DLYPHUCRP(IV,IJDX) + DLYPHU
	IF(DLYPHU.LT.0.001) GO TO 784
  212 PHUCX(IV)=PHUCX(IV) + DLYPHU+ TBS

  204 IMATD=IMATD + 1
C     CALCULATE ACCUMULATED HEAT UNITS BY CROP VARIETY
      IF(IMATD.GT.IPLTDAYS(IV)) GO TO 784
      PHUC(IV) = PHUC(IV) + DLYPHU
	DLYPHUCRP(IV,IJULD) =  PHUC(IV)
  786 CONTINUE
  785 CONTINUE
  784 CONTINUE


C 2033 WRITE(KW(29),1205) IBCRP,IGRID12A,IPLTDATE,IPLTDAYS(1),IMATD,
C     &XLOG12A,YLAT12A,THRESHOLD,TBS,RAMX,HRLT,NUMBERM,STATWTHFM,YLATM,
C     &XLOXM,DM,IGRID12A,XLOG12A,YLAT12A,ELEV12A,SLGRID12A,IHUC8,IREG,
C     &IFIPS,CROP,GRASS,AG,COUNTRY,CPROV,ELEV12A,ELEVSTAT,DXELEVM


C     WRITE HEAT UNITS BY VARIETY
      DO 332 IDAY =1,365
      WRITE(KW(26),333) XLOG12A,YLAT12A,IBELD4X,IDAY,
     &(DLYPHUCRP(IVT,IDAY),IVT=1,11),IPLTDATE
  333 FORMAT(1X,2F10.3,2I5,11F10.2,I5)
  332 CONTINUE

C     DETERMINE VARIETY TO BE GROWN BY SITE
      DO 221 IV= IVARB,10
	IVX=IV
	IF(IPLTDAYS(IV).EQ.0) GO TO 221
	IF(DRYDOWN.GT.0.01) GO TO 334
      GO TO 335
C     ADJUST DRYDOWN FRACTION AS LATITUDE INCREASES BEYOND 38 DEGREES
  334	VARRISK=1.0 + DRYDOWN

	IJULDV=IPLTDATE-2+IPLTDAYS(IV)
	IF(IJULDV>IJDX) GO TO 221
C     HEAT UNIT ADJUSTMENT TO REFLECT RISK OF EARLY FALL FROST ON VARIETY SELECTION
C     VARIETY SELECTION RISK FACTOR (VARRISK) IS SET AT  1.25 FOR 37 DEGREES LATIDUDE 
C     AND HIGHER
C	IF(YLAT12A>36.9999) VARRISK= 1.25
	DRYDOWNHARV=VARRISK	
	WRITE(KW(27),155) IJULDV,IPLTDATE,IPLTDAYS(IVX),DRYDOWN,
     &DRYDOWNHARV,IJDX,VARRISK,IGRID12A,YLAT12A

      HEATUNITS=DLYPHUCRP(IV,IJULDV)*VARRISK

	IF(HEATUNITS.LT.DLYPHUCRP(11,IJDX)) GO TO 222
	GO TO 221
  335 IJULDV=IPLTDATE-2+IPLTDAYS(IV)
  	IF(IJULDV>IJDX) GO TO 221

      HEATUNITS=DLYPHUCRP(IV,IJULDV)
      IF(HEATUNITS.LT.DLYPHUCRP(11,IJDX)) GO TO 222
  221 CONTINUE
      WRITE(KW(12),115) IGRID12A,XLOG12A,YLAT12A,IBELD4X,IEPICCRP,
     1IPLTDATE,PHUCX(IVX)
  222 CONTINUE
	WRITE(KW(27),155) IJULDV,IPLTDATE,IPLTDAYS(IVX),DRYDOWN,
     &DRYDOWNHARV,IJDX
	IF(IJULDV==0.0) GO TO 7777
  155 FORMAT(3I10,2F5.2,I10,F5.2,I10,F10.2)
      WRITE(KW(28),337) XLOG12A,YLAT12A,IBELD4X,IJULDV,IJDX,IPLTDATE
C     &(DLYPHUCRP(IVT,IJULDV),IVT=1,10),DLYPHUCRP(11,IJDX),IPLTDATE
  337 FORMAT(1X,2F10.3,4I5,11F10.2,I5)


C     FALL PLANT DATE IS 700 HEAT UNITS PRIOR TO THE DATE WHEN NO HEAT
C     UNITS ARE ACCUMULATED FOR A CROP
 7777 FALLPLTPHU=0
      IF(SPFLPLT.EQ.1) GO TO 220
      IF(SPFLPLT.EQ.2) GO TO 244
  244 FALLPLTPHU = DLYPHUCRP(11,IJDX)-(600*48/YLAT12A)
      DO 241 IJ = 1,364
	IF(DLYPHUCRP(11,IJ).GT.FALLPLTPHU) GO TO 242
  241 CONTINUE
  242 IPLTDATE=IJ-1
C     PLANT DATE VARIBLE DAY DISTRIBUTION

C     modified for EPA scenario comparison
C          IX = IX_CROP
C          CALL DAGEN(IX,IDA,PLTRANGE)

      CALL RANDOM_SEED (PUT=IX_seed)
      CALL RANDOM_NUMBER (randNum)
      IDA = int(randNum * PLTRANGE) + 1

      IPLTDATE = IPLTDATE + IDA
      
C      write(*,*) "2 IPLTDATE=",IPLTDATE," IDA=",IDA," PLTRANGE=",PLTRANGE," IX_CROP=",IX_CROP

C
  220 CONTINUE


      IF (IPLTDATE.GT.31) GO TO 224 
	  MONTH = 1
        MDAY = IPLTDATE
	 GO TO 240
  224 IF (IPLTDATE.GT.59) GO TO 225
        MONTH = 2
        MDAY = IPLTDATE - 31
	  GO TO 240
  225 IF (IPLTDATE.GT.90) GO TO 226
        MONTH = 3
        MDAY = IPLTDATE - 59
	  GO TO 240
  226 IF (IPLTDATE.GT.120) GO TO 227
        MONTH = 4
        MDAY = IPLTDATE - 90	
	  GO TO 240
  227 IF (IPLTDATE.GT.151) GO TO 228
        MONTH = 5
        MDAY = IPLTDATE - 120	
	  GO TO 240
  228 IF (IPLTDATE.GT.181) GO TO 229
        MONTH = 6
        MDAY = IPLTDATE - 151	
	  GO TO 240
  229 IF (IPLTDATE.GT.212) GO TO 230
        MONTH = 7
        MDAY = IPLTDATE - 181	
	  GO TO 240
  230 IF (IPLTDATE.GT.243) GO TO 231
        MONTH = 8
        MDAY = IPLTDATE - 212	
	  GO TO 240
  231 IF (IPLTDATE.GT.273) GO TO 232
        MONTH = 9
        MDAY = IPLTDATE - 243	
	  GO TO 240
  232 IF (IPLTDATE.GT.304) GO TO 233
        MONTH = 10
        MDAY = IPLTDATE - 273	
	  GO TO 240
  233 IF (IPLTDATE.GT.334) GO TO 234
        MONTH = 11
        MDAY = IPLTDATE - 304	
	  GO TO 240
  234   MONTH = 12
        MDAY = IPLTDATE - 334
  240 CONTINUE
C     TEST FOR IJDX = 0
C      IF(IJDX.EQ.0) IJDX=1
  	WRITE(KW(11),113)IGRID12A,XLOG12A,YLAT12A,IBELD4X,IEPICCRP,
     1IPLTDATE,PHUCX(IVX),TMAX(6),TMIN(6),DLYPHU,DLYPHUCRP(11,IJDX),
     &IJDX,
	2((IPLTDAYS(IV),PHUC(IV)),IV=1,10),PHUI(IPLTDATE),PHUC(IVX),
	3IPLTDAYS(IVX),IJULDV,MONTH,MDAY
	WRITE(KW(10),114)IGRID12A,XLOG12A,YLAT12A,IBELD4X,IEPICCRP,
     1IPLTDATE,IPLTDAYS(IVX),PHUC(IVX),ISTATE
C
C     CREATE EPIC RUNFILE
      RUNNAME = IGRID12A*1000 + IBELD4X
      SOILNUMBER = IGRID12A*100 + IBELD4X
C	SOILNUMBER = IHUC8*100 + IBELD4X
      MANAGEMENT = IGRID12A*1000 + IBELD4X
      SITENUMBER = IGRID12A*10

C     CHECK FOR ABSENCE OF MATCHING SOIL FILE
      DO 1020 NM=1,NMX

C     HUC8 NO SOIL TEST
C	IF(IBELD4.EQ.NMBELD4(NM).AND.IHUC8.EQ.NMHUC8(NM)) GO TO 1022
C     12KM GRID NO SOIL TEST
	IF(IBELD4.EQ.NMBELD4(NM).AND.IGRID12A.EQ.NIGRID12KM(NM)) GO TO
     1 1022

 1020 CONTINUE


      WRITE(KW(13),116) RUNNAME,SITENUMBER,SOILNUMBER,MANAGEMENT
      WRITE(KW(22),126) RUNNAME,SITENUMBER,RUNNAME,MANAGEMENT,IGRID12A


C     CREATE SEPARATE RAINFED AND IRRIGATED RUNFILES
      IBCRP=IBELD4 -21
      GO TO(40,41,40,41,40,41,40,41,40,41,40,41,40,41,40,41,40,41,40,41,
     140,41,40,41,40,41,40,41,40,41,40,41,40,41,40,41,40,41,40,41,40,
     241,42,42,42,40,41,40,41),IBCRP
   40 WRITE(KW(16),116) RUNNAME,SITENUMBER,SOILNUMBER,MANAGEMENT
      WRITE(KW(23),126) RUNNAME,SITENUMBER,RUNNAME,MANAGEMENT,IGRID12A
      GO TO 42
   41 WRITE(KW(17),116) RUNNAME,SITENUMBER,SOILNUMBER,MANAGEMENT
      WRITE(KW(24),126) RUNNAME,SITENUMBER,RUNNAME,MANAGEMENT,IGRID12A

   42 CONTINUE

C     CREATE SOILIST FILE
      WRITE(KRF(9),996) RUNNAME,RUNNAME
  996 FORMAT(1X,I10,4X,I12,'.SOL')
C
 1022 CONTINUE
      WRITE(KW(8),110)IBELD4X,IEPICCRP,ECROP,TOP,TBS,CNY,CPY,WCYA,IDC,
     2GMHU,PPL1,PPL2,ESTPLTPOP,SPFLPLT,DRYDOWN,(IPLTDAYS(K),K=1,10),
	3DRYDOWNHARV

      WRITE(KW(9),112)IGRID12A,XLOG12A,YLAT12A,ELEV12A,
     1IHUC8,IREG,IFIPS,IPLTDATE,(PHUC(IV),IV=1,10),
	2SUMPHUNC,ADLYPHUNC(IPLTDATE),IBELD4X,IEPICCRP,ECROP

C     OPEN MANAGEMENT FILE
	WRITE(KW(15),118) MANAGEMENT
	WRITE(KW(25),118) MANAGEMENT

  118 FORMAT(1X,I9)
      REWIND KW(15)
	READ(KW(15),119) OPSNAME 
	REWIND KW(15)
  119 FORMAT(1X,A9)
      CALL OPENV(KW(14),OPSNAME//AXT(1), OPCDIR, 'W')
	WRITE(KW(14),117) MANAGEMENT,IBELD4X,IEPICCRP,ECROP,XLOG12A,
     1YLAT12A,ELEV12A,SLGRID12A,IHUC8,IREG,IFIPS,CROP,GRASS,AG,
     2COUNTRY,CPROV
	WRITE(KW(20),127) MANAGEMENT,MANAGEMENT,IBELD4X,IEPICCRP,ECROP,
     1XLOG12A,YLAT12A,ELEV12A,SLGRID12A,IHUC8,IREG,IFIPS,CROP,GRASS,AG,
     2COUNTRY,CPROV
  127 FORMAT(1X,I10,I10,'.OPC',2(1X,I5),2X,A4,2F10.4,2X,F7.1,F7.4,2X,
     1I10,2X,I2,2X,I5,3(2X,F7.3),2A8)

  117 FORMAT(I10,'.OPS',2(1X,I5),2X,A4,2F10.4,2X,F7.1,F7.4,2X,I10,2X,
     1I2,2X,I5,3(2X,F7.3),2A8)

C     FNP IS THE AMOUNT OF ELEMENTAL N APPLIED IF A STRESS TRIGGERED APPLICATION
C     IS MADE. CURRENTLY 20% OF THE SPINUP AVERAGE N APPLIED PER YEAR
      FNP = FERTAPPGRID(IGRID12A,IBELD4X) * 0.3
      WRITE(KW(14),120) LUN,IAUI,FNP
  120 FORMAT(2I4,F8.2)
      TRACTOR = 0
      IBC = IBELD4X-21
	IB=IBELD4X
	IR=IREG
C	WRITE(KW(14),177) IBC
  177 FORMAT(1X,I5)
C     ADD ADJUSTED DRYDOWNHARV
C      IF(0.01<DRYDOWNLATADJ<1.0) HARVTIME(IR,IB)=1.0 + DRYDOWNHARV
      WCYX=0
      IF(HARVTIME(IR,IB).EQ.1.0) WCYX=WCY(IB) + .01

      IF(PHUC(IVX)<0.1) PHUC(IVX) = 1500.	
      GO TO (300,310,320,330,340,350,360,370,380,390,400, 410,420,430,
     1440,450,460,470,480,490,500,510,520,530,540,550,560,570,580,590,
	2600,610,620,630,640,650,660,670,680,690,700,710),IBC


C     RAINFED HAY BELD4 = 22
  300 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC

        IFERTN = 22
        IFERTP = 23
C       WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
        CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
        CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C       FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C     CHECK TO SEE IF HAY CROP IS ALFALFA (CROP 31) AND SKIP FERTILIZER N
C     IF ALFALFA
C       IF(IEPICCRP.EQ.31) GO TO 301
C     WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
  301   IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

C     REDUCE RAINFED PLANT POPULATION BY 25 PERECNT WEST OF 100th MERIDAN
C     for RAINFED
C     DON'T ADJUST POPULATION IF IRRIGATED
      GO TO (82,83,82,83,82,83,82,83,82,83,82,83,82,83,82,83,82,83,
     182,83,82,83,82,83,82,83,82,83,82,83,82,83,82,83,82,83,
     282,83,82,83,82,83,82,83,82,83),IBC
C     ADJUST FAR WEST SEEDING RATE NOT USED
C   82  IF(XLOG12A.LT.(-100))
   82   IF(XLOG12A.LT.(-100))

     1ESTPLTPOP=ESTPLTPOP*0.75
   83 CONTINUE

C     ADJUST FERTMAX TO SPINUP BY CROP FOR HAY AND OTHER GRASS
      FERTMAXHAYGRASS = FERTAPPGRID(IGRID12A,IBELD4CROP)
C     REDUCE FERTILIZER ON BERMUDA HAY TO 60% OF FERTMAXHAYGRASS
      IF(IBELD4CROP==22)
C     1FERTMAXHAYGRASS = FERTAPPGRID(IGRID12A,IB)*FERTADJHAYRF(ISTATE)
     1FERTMAXHAYGRASS = FERTAPPGRID(IGRID12A,IB) / 1.1 * 0.8
C       1FERTMAXHAYGRASS = 150

C     ADJUST FAR WEST FERTILIZER MAX NOT USED
C      IF(XLOG12A.GT.(-100).OR.XLOG12A.LT.(-118))
C
C      IF(XLOG12A.GT.(-100))
      WRITE(KW(14),1122)PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1FERTMAXHAYGRASS,PHUI(IPLTDATE)
 1122 FORMAT('  1','  1','  1',3I5,5X,F8.0,8X,8X,8X,2F8.2,F8.3)
C      IF(XLOG12A>-118.AND.XLOG12A<-100)
C      IF(XLOG12A<-100)
C     1WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
C     1PHUI(IPLTDATE)
        HUSCHED=.3
        CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
        WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1(HARVTIME(IR,IB)+0.05)
        WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1(HARVTIME(IR,IB)+0.15)
        WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1(HARVTIME(IR,IB)+0.2)

        IGRAZESTART =426
        GRAZESTARTHU= 0.0
        GRAZESTOPHU = 0.0
        IGRAZESTOP =427
        WRITE(KW(14),125)IGRAZESTART,TRACTOR,IEPICCRP,
     1GRAZESTARTHU

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
        WRITE(KW(14),128)IGRAZESTOP,TRACTOR,IEPICCRP,
     1GRAZESTOPHU
C     SHREDDER TO RESET HEAT UNITS BEFORE NEXT YEAR
        ISHREDDER = 331
        WRITE(KW(14),128)ISHREDDER,TRACTOR,IEPICCRP,
     1GRAZESTOPHU


  121 FORMAT('  1','  1','  1',4I5,F8.1,8X,8X,8X,8X,8X,F8.3)
  122 FORMAT('  1','  1','  1',3I5,5X,F8.0,8X,8X,8X,F8.2,8X,F8.3)
  125 FORMAT('  1','  1','  1',3I5,5X,8X,8X,8X,8X,8X,8X,F8.3)
  128 FORMAT('  1',' 12',' 31',3I5,5X,8X,8X,8X,8X,8X,8X,F8.3)
 7125 FORMAT('  1','  1','  1',3I5,5X,8X,8X,8X,8X,8X,8X,F8.3,8X,F8.3)


      GO TO 30
C     IRRIGATED HAY BELD4 = 23
  310 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
	IF(IEPICCRP.EQ.31) GO TO 311 
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
  311	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

C     ADJUST FERTMAX TO SPINUP BY CROP FOR HAY AND OTHER GRASS
      FERTMAXHAYGRASS = FERTAPPGRID(IGRID12A,IBELD4CROP)
C     INCREASE FERTILIZER ON BERMUDA HAY AND GRASS TO 150% OF FERTMAXHAYGRASS
      IF(IBELD4CROP==23)
C     1FERTMAXHAYGRASS = FERTAPPGRID(IGRID12A,IB)*FERTADJHAYIR(ISTATE)
     1FERTMAXHAYGRASS = FERTAPPGRID(IGRID12A,IB) / 1.1 * 0.8

C       IF(XLOG12A.GT.(-100))
      WRITE(KW(14),1122)PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1FERTMAXHAYGRASS,PHUI(IPLTDATE)
C      IF(XLOG12A<-100)
C     1WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
C     1PHUI(IPLTDATE)


C       WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
C     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1(HARVTIME(IR,IB)+0.05)
     	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1(HARVTIME(IR,IB)+0.15)
	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1(HARVTIME(IR,IB)+0.2)
        WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1(HARVTIME(IR,IB)+0.2)


      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	ISHREDDER = 331
	WRITE(KW(14),128)ISHREDDER,TRACTOR,IEPICCRP,
     1GRAZESTOPHU

      GO TO 30
C     RAINFED ALFALFA BELD4 = 24
  320 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

C     REDUCE RAINFED PLANT POPULATION BY 25 PERECNT WEST OF 100th MERIDAN
	IF(XLOG12A.LT.(-100)) 
     1ESTPLTPOP=ESTPLTPOP*0.75

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1(HARVTIME(IR,IB)+0.05) 
	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1(HARVTIME(IR,IB)+0.15)
        WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1(HARVTIME(IR,IB)+0.2)

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	ISHREDDER = 331
	WRITE(KW(14),128)ISHREDDER,TRACTOR,IEPICCRP,
     1GRAZESTOPHU


      GO TO 30
C     IRRIGATED ALFALFA BELD4 = 25
  330 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1(HARVTIME(IR,IB)+0.05)
	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1(HARVTIME(IR,IB)+0.15)
	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1(HARVTIME(IR,IB)+0.2)
        WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1(HARVTIME(IR,IB)+0.2)

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	ISHREDDER = 331
	WRITE(KW(14),128)ISHREDDER,TRACTOR,IEPICCRP,
     1GRAZESTOPHU


      GO TO 30
C     RAINFED OTHER GRASS BELD4 = 26
  340 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
        IFERTN = 22
        IFERTP = 23
C       WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
        CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
        CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C       FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
        IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

C     REDUCE RAINFED PLANT POPULATION BY 25 PERECNT WEST OF 100th MERIDAN
        IF(XLOG12A.LT.(-100))
     1ESTPLTPOP=ESTPLTPOP*0.75

C     ADJUST FERTMAX TO SPINUP BY CROP FOR HAY AND OTHER GRASS
      FERTMAXHAYGRASS = FERTAPPGRID(IGRID12A,IBELD4CROP)
C     INCREASE FERTILIZER ON BERMUDA HAY AND GRASS TO 150% OF FERTMAXHAYGRASS
      IF(IBELD4CROP==26)
C     1FERTMAXHAYGRASS = FERTAPPGRID(IGRID12A,IB)*FERTADJOTHGRASS(ISTATE)
*1.5
     1FERTMAXHAYGRASS = FERTAPPGRID(IGRID12A,IB) / 1.1 * 0.8
      WRITE(KW(14),1122)PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1FERTMAXHAYGRASS,PHUI(IPLTDATE)

        HUSCHED=.3
        CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
        WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1(HARVTIME(IR,IB)+0.05)
        WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1(HARVTIME(IR,IB)+0.15)
        WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1(HARVTIME(IR,IB)+0.2)
        IGRAZESTART =426
        GRAZESTARTHU= 0.0

        GRAZESTOPHU = 0.0
        IGRAZESTOP =427
        WRITE(KW(14),125)IGRAZESTART,TRACTOR,IEPICCRP,
     1GRAZESTARTHU

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

        WRITE(KW(14),128)IGRAZESTOP,TRACTOR,IEPICCRP,
     1GRAZESTOPHU

        ISHREDDER = 331
        WRITE(KW(14),128)ISHREDDER,TRACTOR,IEPICCRP,
     1GRAZESTOPHU


      GO TO 30
C     IRRIGATED OTHER GRASS BELD4 = 27
  350 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

C     ADJUST FERTMAX TO SPINUP BY CROP FOR HAY AND OTHER GRASS
      FERTMAXHAYGRASS = FERTAPPGRID(IGRID12A,IBELD4CROP)
C     INCREASE FERTILIZER ON BERMUDA HAY AND GRASS TO 150% OF FERTMAXHAYGRASS
      IF(IBELD4CROP==27)
C     1FERTMAXHAYGRASS = FERTAPPGRID(IGRID12A,IB)*1.5
     1FERTMAXHAYGRASS = FERTAPPGRID(IGRID12A,IB) / 1.1 * 0.8

      WRITE(KW(14),1122)PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1FERTMAXHAYGRASS,PHUI(IPLTDATE)
C       WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
C     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1(HARVTIME(IR,IB)+0.05)
	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1(HARVTIME(IR,IB)+0.15)
	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1(HARVTIME(IR,IB)+0.2)
        WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1(HARVTIME(IR,IB)+0.2)


      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	ISHREDDER = 331
	WRITE(KW(14),128)ISHREDDER,TRACTOR,IEPICCRP,
     1GRAZESTOPHU

      GO TO 30
C     RAINFED BARLEY BELD4 = 28
  360 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

C     REDUCE RAINFED PLANT POPULATION BY 25 PERECNT WEST OF 100th MERIDAN
	IF(XLOG12A.LT.(-100)) 
     1ESTPLTPOP=ESTPLTPOP*0.75

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
C	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
C     1HARVTIME(IR,IB)
	WRITE(KW(14),7125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB),WCYX 

C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)


      GO TO 30
C     IRRIGATED BARLEY BELD4 = 29
  370 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
C	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
C     1HARVTIME(IR,IB) 
	WRITE(KW(14),7125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB),WCYX 
C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)


      GO TO 30
C     RAINFED BEANS EDIBLE BELD4 = 30
  380 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      FERTRATE = 15
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

C     REDUCE RAINFED PLANT POPULATION BY 25 PERECNT WEST OF 100th MERIDAN
	IF(XLOG12A.LT.(-100)) 
	1ESTPLTPOP=ESTPLTPOP*0.75

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
C	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
C     1HARVTIME(IR,IB) 
	WRITE(KW(14),7125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB),WCYX 

C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)


      GO TO 30
C     IRRIGATED BEANS EDIBLE BELD4 = 31
  390 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      FERTRATE = 15
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
C	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
C     1HARVTIME(IR,IB) 
	WRITE(KW(14),7125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB),WCYX 

C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)


      GO TO 30
C     RAINFED CORN GRAIN BELD4 = 32
  400 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

C     REDUCE RAINFED PLANT POPULATION BY 25 PERECNT WEST OF 100th MERIDAN
	IF(XLOG12A.LT.(-100)) 
	1ESTPLTPOP=ESTPLTPOP*0.75

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)

	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
C	HUSCHED=.4
C	FERTRATE =0.0
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED


      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
	WRITE(KW(14),7125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB),WCYX 
C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
      GO TO 30
C     IRRIGATED CORN GRAIN BELD4 = 33
  410 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)


C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
      HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
C      HUSCHED=.4
C	FERTRATE =0.0
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
	WRITE(KW(14),7125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB),WCYX 
C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 
      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)


      GO TO 30
C     RAINFED CORN SILAGE BELD4 = 34
  420 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

C     REDUCE RAINFED PLANT POPULATION BY 25 PERECNT WEST OF 100th MERIDAN
	IF(XLOG12A.LT.(-100)) 
	1ESTPLTPOP=ESTPLTPOP*0.75

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB) 
C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      GO TO 30
C     IRRIGATED CORN SILAGE BELD4 = 35
  430 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB) 
C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      GO TO 30
C     RAINFED COTTON BELD4 = 36
  440 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

C     REDUCE RAINFED PLANT POPULATION BY 25 PERECNT WEST OF 100th MERIDAN
	IF(XLOG12A.LT.(-100)) 
	1ESTPLTPOP=ESTPLTPOP*0.75

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
C	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
C     1HARVTIME(IR,IB) 
	WRITE(KW(14),7125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB),WCYX 

C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)


      GO TO 30
C     IRRIGATED COTTON BELD4 = 37
  450 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
C	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
C     1HARVTIME(IR,IB) 
	WRITE(KW(14),7125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB),WCYX 

C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)


      GO TO 30
C     RAINFED OATS BELD4 = 38
  460 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

C     REDUCE RAINFED PLANT POPULATION BY 25 PERECNT WEST OF 100th MERIDAN
	IF(XLOG12A.LT.(-100)) 
	1ESTPLTPOP=ESTPLTPOP*0.75

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
C	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
C     1HARVTIME(IR,IB) 
	WRITE(KW(14),7125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB),WCYX 

C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)


      GO TO 30
C     IRRIGATED OATS BELD4 = 39
  470 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
C	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
C     1HARVTIME(IR,IB) 
	WRITE(KW(14),7125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB),WCYX 

C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)


      GO TO 30
C     RAINFED PEANUTS BELD4 = 40
  480 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      FERTRATE = 15
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

C     REDUCE RAINFED PLANT POPULATION BY 25 PERECNT WEST OF 100th MERIDAN
	IF(XLOG12A.LT.(-100)) 
	1ESTPLTPOP=ESTPLTPOP*0.75

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)


      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB) 
C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      GO TO 30
C     IRRIGATED PEANUTS BELD4 = 41
  490 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      FERTRATE = 15
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB) 
C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      GO TO 30
C     RAINFED POTATOES BELD4 = 42
  500 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

C     REDUCE RAINFED PLANT POPULATION BY 25 PERECNT WEST OF 100th MERIDAN
	IF(XLOG12A.LT.(-100)) 
	1ESTPLTPOP=ESTPLTPOP*0.75

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB) 

C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      GO TO 30
C     IRRIGATED POTATOES BELD4 = 43
  510 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB) 
C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)


      GO TO 30
C     RAINFED RICE BELD4 = 44
  520 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

C     REDUCE RAINFED PLANT POPULATION BY 25 PERECNT WEST OF 100th MERIDAN
C	IF(XLOG12A.LT.(-100)) ESTPLTPOP=ESTPLTPOP*0.75

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
C	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
C     1HARVTIME(IR,IB) 
	WRITE(KW(14),7125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB),WCYX 

C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)


      GO TO 30
C     IRRIGATED RICE BELD4 = 45
  530 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
C	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
C     1HARVTIME(IR,IB) 
	WRITE(KW(14),7125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB),WCYX 

C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)


      GO TO 30
C     RAINFED RYE BELD4 = 46
  540 CONTINUE
      HUSCHED = 0.2
	CALL FALLPLTSPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
C	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
C     1HARVTIME(IR,IB) 
	WRITE(KW(14),7125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB),WCYX 

C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 


C     IFERT1 = IPLTDATE - PREPLTFERTDAYS
C      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)

      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

	NDAY = MDAY-PREPLTFERTDAYS
	IF(NDAY.LT.1) GO TO 541
      GO TO 542
  541 NMONTH = MONTH -1
      NDAY = 30 - NDAY
C	WRITE(KW(14),123) NMONTH,NDAY,FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C	1FERTP(IBELD4)

C	WRITE(KW(14),123) NMONTH,NDAY,FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,
C	1FERTRATE
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

	GO TO 543
  542	CONTINUE
C     WRITE(KW(14),123) MONTH,NDAY,FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C	1FERTP(IBELD4)

C      WRITE(KW(14),123) MONTH,NDAY,FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,
C     1FERTRATE
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

  543 CONTINUE
	NDAY = MDAY-PREPLTTILLTIME(IR,IB)
	IF(NDAY.LT.1) GO TO 544
      GO TO 545
  544 NMONTH = MONTH -1
      NDAY = 30 - NDAY
	WRITE(KW(14),123) NMONTH,NDAY,PREPLTTILLNUM(IR,IB),TRACTOR,
     1IEPICCRP
	GO TO 546
  545	WRITE(KW(14),123) MONTH,NDAY,PREPLTTILLNUM(IR,IB),TRACTOR,
     1IEPICCRP
  546 CONTINUE

C     REDUCE RAINFED PLANT POPULATION BY 25 PERECNT WEST OF 100th MERIDAN
	IF(XLOG12A.LT.(-100)) 
	1ESTPLTPOP=ESTPLTPOP*0.75

	WRITE(KW(14),124) MONTH,MDAY,PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),
     1ESTPLTPOP

      GO TO 30
C     IRRIGATED RYE BELD4 = 47
  550 CONTINUE
      HUSCHED = 0.2
	CALL FALLPLTSPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
C	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
C     1HARVTIME(IR,IB) 
	WRITE(KW(14),7125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB),WCYX 

C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 


C     IFERT1 = IPLTDATE - PREPLTFERTDAYS
C      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)


	NDAY = MDAY-PREPLTFERTDAYS
	IF(NDAY.LT.1) GO TO 551
      GO TO 552
  551 NMONTH = MONTH -1
      NDAY = 30 - NDAY

	CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	WRITE(KW(14),123) NMONTH,NDAY,FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C	1FERTP(IBELD4)

C	WRITE(KW(14),123) NMONTH,NDAY,FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,
C	1FERTRATE
	GO TO 553
  552	CONTINUE
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C     WRITE(KW(14),123) MONTH,NDAY,FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C	1FERTP(IBELD4)
C      WRITE(KW(14),123) MONTH,NDAY,FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,
C     1FERTRATE
  553 CONTINUE
	NDAY = MDAY-PREPLTTILLTIME(IR,IB)
	IF(NDAY.LT.1) GO TO 554
      GO TO 555
  554 NMONTH = MONTH -1
      NDAY = 30 - NDAY
	WRITE(KW(14),123) NMONTH,NDAY,PREPLTTILLNUM(IR,IB),TRACTOR,
     1IEPICCRP
	GO TO 556
  555	WRITE(KW(14),123) MONTH,NDAY,PREPLTTILLNUM(IR,IB),TRACTOR,
     1IEPICCRP
  556 CONTINUE

	WRITE(KW(14),124) MONTH,MDAY,PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),
     1ESTPLTPOP

      GO TO 30
C     RAINFED SORGHUM GRAIN BELD4 = 48
  560 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
     	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

C     REDUCE RAINFED PLANT POPULATION BY 25 PERECNT WEST OF 100th MERIDAN
	IF(XLOG12A.LT.(-100)) 
	1ESTPLTPOP=ESTPLTPOP*0.75

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
C	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
C     1HARVTIME(IR,IB) 
	WRITE(KW(14),7125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB),WCYX 

C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)


      GO TO 30
C     IRRIGATED SORGHUM GRAIN BELD4 = 49
  570 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
C	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
C     1HARVTIME(IR,IB) 
	WRITE(KW(14),7125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB),WCYX 

C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      GO TO 30
C     RAINFED SORGHUM SILAGE BELD4 = 50
  580 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

C     REDUCE RAINFED PLANT POPULATION BY 25 PERECNT WEST OF 100th MERIDAN
	IF(XLOG12A.LT.(-100)) 
	1ESTPLTPOP=ESTPLTPOP*0.75

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB) 
C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      GO TO 30
C     IRRIGATED SORGHUM SILAGE BELD4 = 51
  590 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB) 
C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)


      GO TO 30
C     RAINFED SOYBEANS BELD4 = 52
  600 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      FERTRATE = 15
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

C     REDUCE RAINFED PLANT POPULATION BY 25 PERECNT WEST OF 100th MERIDAN
	IF(XLOG12A.LT.(-100)) 
	1ESTPLTPOP=ESTPLTPOP*0.75

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
C	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
C     1HARVTIME(IR,IB) 
	WRITE(KW(14),7125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB),WCYX 

C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)


      GO TO 30
C     IRRIGATED SOYBEANS BELD4 = 53
  610 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      FERTRATE = 15
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
C	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
C     1HARVTIME(IR,IB) 
	WRITE(KW(14),7125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB),WCYX 

C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)


      GO TO 30
C     RAINFED WHEAT SPRING BELD4 = 54
  620 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

C     REDUCE RAINFED PLANT POPULATION BY 25 PERECNT WEST OF 100th MERIDAN
	IF(XLOG12A.LT.(-100)) 
	1ESTPLTPOP=ESTPLTPOP*0.75

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
C	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
C     1HARVTIME(IR,IB) 
	WRITE(KW(14),7125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB),WCYX 

C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 


      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      GO TO 30
C     IRRIGATED WHEAT SPRING BELD4 = 55
  630 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
C	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
C     1HARVTIME(IR,IB) 
	WRITE(KW(14),7125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB),WCYX 

C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)


      GO TO 30
C     RAINFED WHEAT WINTER BELD4 = 56
  640 CONTINUE

C  EPA   7/11/16 by ECooter
          if(IREG.ne.10)write(KW(14),7199)TRACTOR,IEPICCRP
7199      format('  1','  1','  1','  331',2i5,5x,6(8x),'     .25')
C  EPA  7/11/16

  	IFERTN = 22  
	IFERTP = 23

	HUSCHED = 0.2
  	CALL FALLPLTSPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
C	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
C     1HARVTIME(IR,IB) 
	WRITE(KW(14),7125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB),WCYX 

C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 


C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
      NDAY = MDAY-PREPLTFERTDAYS
	IF(NDAY.LT.1) GO TO 641
      GO TO 642
  641 NMONTH = MONTH -1
      NDAY = 30 - NDAY
	CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	WRITE(KW(14),123) NMONTH,NDAY,FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C	1FERTP(IBELD4)

C	WRITE(KW(14),123) NMONTH,NDAY,FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,
C	1FERTRATE
	GO TO 643
  642	CONTINUE
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C     WRITE(KW(14),123) MONTH,NDAY,FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C	1FERTP(IBELD4)
C      WRITE(KW(14),123) MONTH,NDAY,FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,
C     1FERTRATE
  643 CONTINUE
	NDAY = MDAY-PREPLTTILLTIME(IR,IB)
	IF(NDAY.LT.1) GO TO 644
      GO TO 645
  644 NMONTH = MONTH -1
      NDAY = 30 - NDAY
	WRITE(KW(14),123) NMONTH,NDAY,PREPLTTILLNUM(IR,IB),TRACTOR,
     1IEPICCRP
	GO TO 646
  645	WRITE(KW(14),123) MONTH,NDAY,PREPLTTILLNUM(IR,IB),TRACTOR,
     1IEPICCRP
  646 CONTINUE

C     REDUCE RAINFED PLANT POPULATION BY 25 PERECNT WEST OF 100th MERIDAN
	IF(XLOG12A.LT.(-100)) 
	1ESTPLTPOP=ESTPLTPOP*0.75

	WRITE(KW(14),124) MONTH,MDAY,PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),
     1ESTPLTPOP
  123 FORMAT('  1',2I3,4I5,F8.0,8X,8X,8X,8X,8X,F8.2)
  124 FORMAT('  1',2I3,3I5,5X,F8.0,8X,8X,8X,F8.2,8X,F8.2)
      GO TO 30
C     IRRIGATED WHEAT WINTER BELD4 = 57
  650 CONTINUE

!  EPA   7/11/16 by ECooter
          if(IREG.ne.3.and.IREG.ne.6)write(KW(14),7299)TRACTOR,IEPICCRP
7299      format('  1','  1','  1','  331',2i5,5x,6(8x),'     .25')
!  EPA  7/11/16

      HUSCHED = 0.2
  	CALL FALLPLTSPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
C	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
C     1HARVTIME(IR,IB) 
	WRITE(KW(14),7125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB),WCYX 

C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 


C      IFERT1 = IPLTDATE - PREPLTFERTDAYS
C      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
	NDAY = MDAY-PREPLTFERTDAYS
	IF(NDAY.LT.1) GO TO 651
      GO TO 652
  651 NMONTH = MONTH -1
      NDAY = 30 - NDAY

	CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	WRITE(KW(14),123) NMONTH,NDAY,FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C	1FERTP(IBELD4)

C	WRITE(KW(14),123) NMONTH,NDAY,FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,
C	1FERTRATE
	GO TO 653
  652	CONTINUE

	CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C     WRITE(KW(14),123) MONTH,NDAY,FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C	1FERTP(IBELD4)
C      WRITE(KW(14),123) MONTH,NDAY,FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,
C     1FERTRATE
  653 CONTINUE
	NDAY = MDAY-PREPLTTILLTIME(IR,IB)
	IF(NDAY.LT.1) GO TO 654
      GO TO 655
  654 NMONTH = MONTH -1
      NDAY = 30 - NDAY
	WRITE(KW(14),123) NMONTH,NDAY,PREPLTTILLNUM(IR,IB),TRACTOR,
     1IEPICCRP
	GO TO 656
  655	WRITE(KW(14),123) MONTH,NDAY,PREPLTTILLNUM(IR,IB),TRACTOR,
     1IEPICCRP
  656 CONTINUE

	WRITE(KW(14),124) MONTH,MDAY,PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),
     1ESTPLTPOP

      GO TO 30
C     RAINFED OTHER CROP BELD4 = 58
  660 IF(IPLTDATE<10) IPLTDATE=150
      IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

C     REDUCE RAINFED PLANT POPULATION BY 25 PERECNT WEST OF 100th MERIDAN
	IF(XLOG12A.LT.(-100)) 
	1ESTPLTPOP=ESTPLTPOP*0.75

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
C	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
C     1HARVTIME(IR,IB) 
	WRITE(KW(14),7125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB),WCYX 

C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)


      GO TO 30
C     IRRIGATED OTHER CROP BELD4 = 59
  670 IF(IPLTDATE<10) IPLTDATE=150
      IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
C	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
C     1HARVTIME(IR,IB) 
	WRITE(KW(14),7125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB),WCYX 

C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)


      GO TO 30

C     RAINFED CANOLA BELD4 = 60
  680 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C      1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

C     REDUCE RAINFED PLANT POPULATION BY 25 PERECNT WEST OF 100th MERIDAN
	IF(XLOG12A.LT.(-100)) 
	1ESTPLTPOP=ESTPLTPOP*0.75

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
C	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
C     1HARVTIME(IR,IB) 
	WRITE(KW(14),7125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB),WCYX 

C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)


      GO TO 30
C     IRRIGATED CANOLA BELD4 = 61
  690 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
C	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
C     1HARVTIME(IR,IB) 
	WRITE(KW(14),7125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB),WCYX 

C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)


      GO TO 30
C     RAINFED FIELD PEAS BELD4 = 62
  700 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

C     REDUCE RAINFED PLANT POPULATION BY 25 PERECNT WEST OF 100th MERIDAN
	IF(XLOG12A.LT.(-100)) 
	1ESTPLTPOP=ESTPLTPOP*0.75

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
C	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
C     1HARVTIME(IR,IB) 
	WRITE(KW(14),7125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB),WCYX 

C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)


      GO TO 30
C     IRRIGATED FIELD PEAS BELD4 = 63
  710 IFERT1 = IPLTDATE - PREPLTFERTDAYS
      HUSCHED = ADLYPHUNC(IFERT1)/SUMPHUNC
	IFERTN = 22  
	IFERTP = 23
C	WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTP,
C     1FERTP(IBELD4),HUSCHED
	CALL MANURE(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)
	CALL SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

C	FERTRATE =FERTN(IBELD4) * PREPLTFERTFRACA(IB)
C      WRITE(KW(14),121) FERTEQUIP,TRACTOR,IEPICCRP,IFERTN,FERTRATE,
C     1HUSCHED
	IPRETILL1 = IPLTDATE - PREPLTTILLTIME(IR,IB)
      HUSCHED = ADLYPHUNC(IPRETILL1)/SUMPHUNC
      WRITE(KW(14),125) PREPLTTILLNUM(IR,IB),TRACTOR,IEPICCRP,HUSCHED

	WRITE(KW(14),122) PLTEQUIP,TRACTOR,IEPICCRP,PHUC(IVX),ESTPLTPOP,
     1PHUI(IPLTDATE)
	HUSCHED=.3
	CALL POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)

      IF(POSTPLTTILL1(IR,IB).GT.0) WRITE(KW(14),125)
     1POSTPLTTILL1(IR,IB),TRACTOR,IEPICCRP,POSTPLTTILL1TIME(IR,IB)
C	WRITE(KW(14),125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
C     1HARVTIME(IR,IB) 
	WRITE(KW(14),7125)HARVEQUIPNUM(IR,IB),TRACTOR,IEPICCRP,
     1HARVTIME(IR,IB),WCYX 

C      TERMINATE CROP 
	WRITE(KW(14),125)KILL,TRACTOR,IEPICCRP 

      HUSCHED = ADLYPHUNC(290)/SUMPHUNC
      CALL FALLFERT(IEPICCRP,HUSCHED,XLOG12A,REGIONDIR)


      GO TO 30


   30 WRITE(KW(14),140)
  140 FORMAT(//////////////1X,'  0')      
 
   	CLOSE (KW(14))




  100 FORMAT(I8,I6,2F10.4,2X,F7.1,F7.4,2X,I10,2X,I2,2X,I5,
     13(2X,F7.3),2A8)
  102 FORMAT(1X,I4,2X,A12,2F8.2,F10.2,1X,I8,1X,2F10.4,2X,F7.1,
     1F7.4,2X,I10,2X,I2,2X,I5,3(2X,F7.3),2A8,3F10.2)
  104 FORMAT(A93)
  105 FORMAT(12F6.2)
  106 FORMAT(1X,I5,4F10.2)
  109 FORMAT(16X,I4,24X,I10,2X,A4,2X,2F6.1,3F8.4,I4,F8.0,3F8.2,
     1I4,F8.2,10I8,I6,2X,I8,2X,F8.2,3(6X,I4))

  110 FORMAT(1X,I3,2X,I3,A4,4X,2F7.2,4X,3F8.4,4X,I4,F8.0,2F8.2,1X,
     1F8.2,2X,I2,2X,F5.1,10I8,F5.2)

  112 FORMAT(1X,I8,1X,2F9.4,F7.1,1X,I8,1X,I2,1X,I5,I5,10F9.2,
     12F10.2,I4,I5,A4)
  113 FORMAT(1X,I8,2F9.4,3I5,5F10.2,I5,10(I5,F10.1),F7.3,F10.0,4I7)
  114 FORMAT(1X,I8,',',2(F9.4,','),4(I5,','),F10.0,','I10)
  115 FORMAT(1X,I8,2F9.4,3I5,3F10.2,5X,'NO VARIETY SELECTED')
  116 FORMAT(1X,I12,2X,I8,3(2X,'0'),2X,I10,2X,I10,2X,'0')
  126 FORMAT(1X,I12,2X,I8,3(2X,'0'),2X,I12,2X,I10,2X,I12)
  130 FORMAT(I2,A16,I4,7(2X,I5),3(2X,F5.2))     

  174 FORMAT(A80)
  748 FORMAT(10X,A24/10X,A24)
 1011 FORMAT(2I8,35X,I6)
 1111 FORMAT(3I8,35X,I6)

 1044 FORMAT(1X,A93)
 1040 FORMAT(A232)
 1045 FORMAT(1X,A232)



  999 CONTINUE
   11 CONTINUE
      GO TO 9
777   stop   
  
      END

      FUNCTION AUNIF(IX)
      ! THIS SUBPROGRAM GENERATES UNIFORM RANDOM NUMBERS.
      K=IX/127773
      IX=16807*(IX-K*127773)-K*2836
      IF(IX<0)IX=IX+2147483647
      AUNIF=IX*4.656612875D-10
      RETURN
      END
!---+----1----+----2----+----3----+----4----+----5----+----6----+----7-*
      SUBROUTINE DAGEN(IX,IDA,PLTRANGE)
      ! THIS SUBPROGRAM GENERATES DAYS FROM 1-10.
      X1=AUNIF(IX) 
      IDA=X1*PLTRANGE+.9999
      IF(IDA==0)IDA=1
      RETURN
      END

      SUBROUTINE MANURE(IEPICCRP,HUSCHED,XLOG12A, DIR)
      CHARACTER(*), INTENT  (IN) ::DIR
      CHARACTER*4 BXT
	CHARACTER*8 BASEX,REGIONNUMBER,REGION,FTNM2012
	CHARACTER*9 TIMINGN
	CHARACTER*22 FERTSALESNAMEEPIC

	INTEGER*8 EQUIPMENT
C
	INTEGER*2 IREG,FERTNUM,MANURETYPE,TRACTOR
      REAL*8 XLOG12A,YLAT12A,FERTNFRAC
      COMMON/BK2/KR(10),KW(30),KRF(10)
        COMMON/BK3/FERTNFRAC(200),FERTCHAR(10),FERTADJOTHGRASS(60),
     1FERTADJHAYRF(60),FERTADJHAYIR(60)
	COMMON/BK4/FERTNUM(200),EQUIPMENT(200,5),FERTAPPGRID(120000,70)
	COMMON/BK6/AXT(2),BXT(42),BASEX(10),FTNM2012(200)
      COMMON/BK7/IGRID12A,IBELD4CROP,IREG,TRACTOR,MANURETYPE(10)
        COMMON/BK8/IMONEND,IDAYEND,ISFA
C
      DATA BXT/'.C22','.C23','.C24','.C25','.C26','.C27','.C28','.C29',
     1'.C30','.C31','.C32','.C33','.C34','.C35','.C36','.C37','.C38',
     2'.C39','.C40','.C41','.C42','.C43','.C44','.C45','.C46','.C47',
     3'.C48','.C49','.C50','.C51','.C52','.C53','.C54','.C55','.C56',
     4'.C57','.C58','.C59','.C60','.C61','.C62','.C63'/BASEX/'REGION01',
	5'REGION02','REGION03','REGION04','REGION05','REGION06','REGION07',
	6'REGION08','REGION09','REGION10'/MANURETYPE/5,10,10,5,130,10,130,
     75,2,5/
C	DO 392 IFRT=1,143
C	WRITE(61,393) IFRT,FTNM2012(IFRT),FERTNFRAC(IFRT)
C  392 CONTINUE
C  393 FORMAT(1X,I4,1X,A8,F8.3)

      REGIONNUMBER = BASEX(IREG)
      IBELD4CROPX = IBELD4CROP-21
	WRITE(61,111) REGIONNUMBER,IBELD4CROPX

	CALL OPENV(62,REGIONNUMBER//BXT(IBELD4CROPX), DIR, 'R')

      TOTCOMFERT= 0
    1	READ(62,111,END=2) REGION,IBELD4CROPX,KERTSALESIDEPIC,
     1FERTSALESNAMEEPIC,K,TIMINGN,I,FERTFRAC
	WRITE(61,111) REGION,IBELD4CROPX,KERTSALESIDEPIC,
     1FERTSALESNAMEEPIC,K,TIMINGN,I,FERTFRAC
  111 FORMAT(1X,A8,I4,9X,I4,1X,A22,1X,I4,1X,A9,I4,F10.4)
      IF(I==1) TOTCOMFERT= TOTCOMFERT+FERTFRAC
	GO TO 1
    2 CONTINUE
      WRITE(61,112) TOTCOMFERT
  112 FORMAT(1X,F10.5)
      IF(TOTCOMFERT<.99) GO TO 4
      GO TO 3
    4 FRACMANURE = 1-TOTCOMFERT
      IFRTX=MANURETYPE(IREG)
	WRITE(61,115) FRACMANURE,FERTAPPGRID(IGRID12A,IBELD4CROP),
     1IGRID12A,IBELD4CROP,IFRTX,FERTNFRAC(IFRTX)
  115 FORMAT(1X,'2',F10.5,F10.5,1X,I6,1X,I4,1X,I4,F10.5)
      IF(FERTNFRAC(IFRTX)*FRACMANURE==0.0) GO TO 10
      FERTRATE=(FERTAPPGRID(IGRID12A,IBELD4CROP)/FERTNFRAC(IFRTX))*
     1FRACMANURE
C     ADJUSTMENT FOR HAY AND OTHER GRASS
C        IF(IBELD4CROP==22)FERTRATE=FERTRATE*FERTADJHAYRF(ISFA)
        IF(IBELD4CROP==22)FERTRATE=FERTRATE

C        IF(IBELD4CROP==23)FERTRATE=FERTRATE*FERTADJHAYIR(ISFA)
        IF(IBELD4CROP==23)FERTRATE=FERTRATE

C        IF(IBELD4CROP==26)FERTRATE=FERTRATE*FERTADJOTHGRASS(ISFA)
        IF(IBELD4CROP==26)FERTRATE=FERTRATE
C
	IF(FERTRATE<0.01) FERTRATE = 0.1
	 GO TO 11
   10 WRITE(61,116)
  116 FORMAT(1X,'IFRTX*FRACMANURE==0.0')
   11	WRITE(61,114) FRACMANURE,FERTRATE,IGRID12A,IBELD4CROP,IFRTX,
     1FERTNFRAC(IFRTX)
  114 FORMAT(1X,'1',F10.5,F12.5,1X,I6,1X,I4,1X,I4,F10.5)
      WRITE(61,121) EQUIPMENT(IFRTX,1),TRACTOR,IEPICCRP,IFRTX,
     1FERTRATE,HUSCHED
C      HUSCHED=0
      WRITE(KW(14),121) EQUIPMENT(IFRTX,1),TRACTOR,IEPICCRP,IFRTX,
     1FERTRATE,HUSCHED
  121 FORMAT('  1','  1','  1',4I5,F8.1,8X,8X,8X,8X,8X,F8.3)

    3 CLOSE(62)
	RETURN
      END

      SUBROUTINE FALLFERT(IEPICCRP,HUSCHED,XLOG12A, DIR)
      CHARACTER(*), INTENT  (IN) ::DIR
      CHARACTER*4 BXT
	CHARACTER*8 BASEX,REGIONNUMBER,REGION,FTNM2012
	CHARACTER*9 TIMINGN
	CHARACTER*22 FERTSALESNAMEEPIC

	INTEGER*8 EQUIPMENT
C
	INTEGER*2 IREG,FERTNUM,MANURETYPE,TRACTOR
      REAL*8 XLOG12A,YLAT12A,FERTNFRAC
      COMMON/BK2/KR(10),KW(30),KRF(10)
        COMMON/BK3/FERTNFRAC(200),FERTCHAR(10),FERTADJOTHGRASS(60),
     1FERTADJHAYRF(60),FERTADJHAYIR(60)
	COMMON/BK4/FERTNUM(200),EQUIPMENT(200,5),FERTAPPGRID(120000,70)
	COMMON/BK6/AXT(2),BXT(42),BASEX(10),FTNM2012(200)
      COMMON/BK7/IGRID12A,IBELD4CROP,IREG,TRACTOR,MANURETYPE(10)
        COMMON/BK8/IMONEND,IDAYEND,ISFA
C
      DATA BXT/'.C22','.C23','.C24','.C25','.C26','.C27','.C28','.C29',
     1'.C30','.C31','.C32','.C33','.C34','.C35','.C36','.C37','.C38',
     2'.C39','.C40','.C41','.C42','.C43','.C44','.C45','.C46','.C47',
     3'.C48','.C49','.C50','.C51','.C52','.C53','.C54','.C55','.C56',
     4'.C57','.C58','.C59','.C60','.C61','.C62','.C63'/BASEX/'REGION01',
	5'REGION02','REGION03','REGION04','REGION05','REGION06','REGION07',
	6'REGION08','REGION09','REGION10'/MANURETYPE/5,10,10,5,130,10,
     7130,5,2,5/
C	DO 392 IFRT=1,143
C	WRITE(61,393) IFRT,FTNM2012(IFRT),FERTNFRAC(IFRT)
C  392 CONTINUE
C  393 FORMAT(1X,I4,1X,A8,F8.3)

      REGIONNUMBER = BASEX(IREG)
      IBELD4CROPX = IBELD4CROP-21
	WRITE(61,111) REGIONNUMBER,IBELD4CROPX
  111 FORMAT(1X,A8,I4,9X,I4,1X,A22,1X,I4,1X,A9,I4,F10.4)


	CALL OPENV (62,REGIONNUMBER//BXT(IBELD4CROPX), DIR, 'R')

    1	READ(62,111,END=2) REGION,IBELD4CROPX,KERTSALESIDEPIC,
     1FERTSALESNAMEEPIC,K,TIMINGN,I,FERTFRAC
	WRITE(61,111) REGION,IBELD4CROPX,KERTSALESIDEPIC,
     1FERTSALESNAMEEPIC,K,TIMINGN,I,FERTFRAC
      IF(I==2) GO TO 3
	GO TO 1
    3 FERTRATE=FERTFRAC*(FERTAPPGRID(IGRID12A,IBELD4CROP)/
     1FERTNFRAC(K))
C     FERTILIZER ADJUSTMENT TO REFLECT ONLY 60 PERCENT OF RAINFED HAY OR OTHER GRASS
C     IS LIKELY TO BE FERTILIZED
C      FERTMAXHAYGRASS = FERTAPPGRID(IGRID12A,IBELD4CROP)*.60
C
C      IF(IBELD4CROP==22.AND.XLOG12A.GT.-100) FERTRATE=FERTFRAC*
C     1(FERTAPPGRID(IGRID12A,IBELD4CROP)/FERTNFRAC(K))*0.6
C	IF(IBELD4CROP==26.AND.XLOG12A.GT.-100) FERTRATE=FERTFRAC*
C     1(FERTAPPGRID(IGRID12A,IBELD4CROP)/FERTNFRAC(K))*0.6
C     ADJUSTMENT FOR HAY AND OTHER GRASS
C        IF(IBELD4CROP==22)FERTRATE=FERTRATE*FERTADJHAYRF(ISFA)
        IF(IBELD4CROP==22)FERTRATE=FERTRATE

C        IF(IBELD4CROP==23)FERTRATE=FERTRATE*FERTADJHAYIR(ISFA)
        IF(IBELD4CROP==23)FERTRATE=FERTRATE

C        IF(IBELD4CROP==26)FERTRATE=FERTRATE*FERTADJOTHGRASS(ISFA)
        IF(IBELD4CROP==26)FERTRATE=FERTRATE
C

	IF(FERTRATE<0.01) FERTRATE = 0.1

C     IF(IBELD4CROP==22.OR.IBELD4CROP==26.AND.XLOG12A.GT.-100)
C     1WRITE(KW(14),122) EQUIPMENT(K,I),TRACTOR,IEPICCRP,K,
C     1FERTRATE,FERTMAXHAYGRASS,HUSCHED
C  122 FORMAT('  1','  1','  1',4I5,F8.1,8X,8X,8X,8X,F8.3,F8.3)
C      IF(IBELD4CROP/=22.AND.IBELD4CROP/=26)
      HUSCHED=0
      WRITE(KW(14),121) EQUIPMENT(K,I),TRACTOR,
     1IEPICCRP,K,FERTRATE,HUSCHED
  121 FORMAT('  1',' 10','  1',4I5,F8.1,8X,8X,8X,8X,8X,F8.3)

      GO TO 1




    2 CLOSE(62)
	RETURN
      END



      SUBROUTINE SPRINGFERT(IEPICCRP,HUSCHED,XLOG12A, DIR)
      CHARACTER(*), INTENT  (IN) ::DIR
      CHARACTER*4 BXT
      CHARACTER*8 BASEX,REGIONNUMBER,REGION,FTNM2012
      CHARACTER*9 TIMINGN
      CHARACTER*22 FERTSALESNAMEEPIC

	INTEGER*8 EQUIPMENT
C
	INTEGER*2 IREG,FERTNUM,MANURETYPE,TRACTOR
      REAL*8 XLOG12A,YLAT12A,FERTNFRAC
      COMMON/BK2/KR(10),KW(30),KRF(10)
        COMMON/BK3/FERTNFRAC(200),FERTCHAR(10),FERTADJOTHGRASS(60),
     1FERTADJHAYRF(60),FERTADJHAYIR(60)
	COMMON/BK4/FERTNUM(200),EQUIPMENT(200,5),FERTAPPGRID(120000,70)
	COMMON/BK6/AXT(2),BXT(42),BASEX(10),FTNM2012(200)
      COMMON/BK7/IGRID12A,IBELD4CROP,IREG,TRACTOR,MANURETYPE(10)
	COMMON/BK8/IMONEND,IDAYEND,ISFA

C
      DATA BXT/'.C22','.C23','.C24','.C25','.C26','.C27','.C28','.C29',
     1'.C30','.C31','.C32','.C33','.C34','.C35','.C36','.C37','.C38',
     2'.C39','.C40','.C41','.C42','.C43','.C44','.C45','.C46','.C47',
     3'.C48','.C49','.C50','.C51','.C52','.C53','.C54','.C55','.C56',
     4'.C57','.C58','.C59','.C60','.C61','.C62','.C63'/BASEX/'REGION01',
	5'REGION02','REGION03','REGION04','REGION05','REGION06','REGION07',
	6'REGION08','REGION09','REGION10'/MANURETYPE/5,10,10,5,130,10,
     7130,5,2,5/
C	DO 392 IFRT=1,143
C	WRITE(61,393) IFRT,FTNM2012(IFRT),FERTNFRAC(IFRT)
C  392 CONTINUE
C  393 FORMAT(1X,I4,1X,A8,F8.3)

      REGIONNUMBER = BASEX(IREG)
      IBELD4CROPX = IBELD4CROP-21
	WRITE(61,111) REGIONNUMBER,IBELD4CROPX
  111 FORMAT(1X,A8,I4,9X,I4,1X,A22,1X,I4,1X,A9,I4,F10.4)


	CALL OPENV(62,REGIONNUMBER//BXT(IBELD4CROPX), DIR, 'R')

    1	READ(62,111,END=2) REGION,IBELD4CROPX,KERTSALESIDEPIC,
     1FERTSALESNAMEEPIC,K,TIMINGN,I,FERTFRAC
	WRITE(61,111) REGION,IBELD4CROPX,KERTSALESIDEPIC,
     1FERTSALESNAMEEPIC,K,TIMINGN,I,FERTFRAC
      IF(I==4) GO TO 3
	GO TO 1
    3 FERTRATE=FERTFRAC*(FERTAPPGRID(IGRID12A,IBELD4CROP)/
     1FERTNFRAC(K))
C     FERTILIZER ADJUSTMENT TO REFLECT ONLY 60 PERCENT OF RAINFED HAY OR OTHER GRASS
C     IS LIKELY TO BE FERTILIZED
C      FERTMAXHAYGRASS = FERTAPPGRID(IGRID12A,IBELD4CROP)*.60
C
C      IF(IBELD4CROP==22.AND.XLOG12A.GT.-100) FERTRATE=FERTFRAC*
C     1(FERTAPPGRID(IGRID12A,IBELD4CROP)/FERTNFRAC(K))*0.6
C	IF(IBELD4CROP==26.AND.XLOG12A.GT.-100) FERTRATE=FERTFRAC*
C     1(FERTAPPGRID(IGRID12A,IBELD4CROP)/FERTNFRAC(K))*0.6
C     ADJUSTMENT FOR HAY AND OTHER GRASS
C      write(*,*) "spring before: ", IBELD4CROP, ISFA, FERTRATE, FERTADJHAYRF(ISFA)
C      write(*,*) "spring before: ", ISFA, FERTADJHAYIR(ISFA),FERTADJOTHGRASS(ISFA)
C	IF(IBELD4CROP==22)FERTRATE=FERTRATE*FERTADJHAYRF(ISFA)
	IF(IBELD4CROP==22)FERTRATE=FERTRATE

C	IF(IBELD4CROP==23)FERTRATE=FERTRATE*FERTADJHAYIR(ISFA)
	IF(IBELD4CROP==23)FERTRATE=FERTRATE

C       IF(IBELD4CROP==26)FERTRATE=FERTRATE*FERTADJOTHGRASS(ISFA)
	IF(IBELD4CROP==26)FERTRATE=FERTRATE

C      write(*,*) "spring after: ", FERTRATE
C


	IF(FERTRATE<0.01) FERTRATE = 0.1

C      IF(IBELD4CROP==22.OR.IBELD4CROP==26.AND.XLOG12A.GT.-100)
C     1WRITE(KW(14),122) EQUIPMENT(K,I),TRACTOR,IEPICCRP,K,
C     1FERTRATE,FERTMAXHAYGRASS,HUSCHED
C  122 FORMAT('  1','  1','  1',4I5,F8.1,8X,8X,8X,8X,F8.3,F8.3)
C      IF(IBELD4CROP/=22.AND.IBELD4CROP/=26)
      WRITE(KW(14),121) EQUIPMENT(K,I),TRACTOR,IEPICCRP,K,
     1FERTRATE,HUSCHED
  121 FORMAT('  1','  1','  1',4I5,F8.1,8X,8X,8X,8X,8X,F8.3)

      GO TO 1



    2 CLOSE(62)
	RETURN
      END


      SUBROUTINE POSTPLTFERT(IEPICCRP,HUSCHED,XLOG12A, DIR)
      CHARACTER(*), INTENT  (IN) ::DIR
      CHARACTER*4 BXT
	CHARACTER*8 BASEX,REGIONNUMBER,REGION,FTNM2012
	CHARACTER*9 TIMINGN
	CHARACTER*22 FERTSALESNAMEEPIC

	INTEGER*8 EQUIPMENT
C
	INTEGER*2 IREG,FERTNUM,MANURETYPE,TRACTOR
      REAL*8 XLOG12A,YLAT12A,FERTNFRAC
      COMMON/BK2/KR(10),KW(30),KRF(10)
	COMMON/BK3/FERTNFRAC(200),FERTCHAR(10),FERTADJOTHGRASS(60),
	1FERTADJHAYRF(60),FERTADJHAYIR(60)
	COMMON/BK4/FERTNUM(200),EQUIPMENT(200,5),FERTAPPGRID(120000,70)
	COMMON/BK6/AXT(2),BXT(42),BASEX(10),FTNM2012(200)
      COMMON/BK7/IGRID12A,IBELD4CROP,IREG,TRACTOR,MANURETYPE(10)
	COMMON/BK8/IMONEND,IDAYEND,ISFA

C
      DATA BXT/'.C22','.C23','.C24','.C25','.C26','.C27','.C28','.C29',
     1'.C30','.C31','.C32','.C33','.C34','.C35','.C36','.C37','.C38',
     2'.C39','.C40','.C41','.C42','.C43','.C44','.C45','.C46','.C47',
     3'.C48','.C49','.C50','.C51','.C52','.C53','.C54','.C55','.C56',
     4'.C57','.C58','.C59','.C60','.C61','.C62','.C63'/BASEX/'REGION01',
	5'REGION02','REGION03','REGION04','REGION05','REGION06','REGION07',
	6'REGION08','REGION09','REGION10'/MANURETYPE/5,10,10,5,130,10,
     7130,5,2,5/
C	DO 392 IFRT=1,143
C	WRITE(61,393) IFRT,FTNM2012(IFRT),FERTNFRAC(IFRT)
C  392 CONTINUE
C  393 FORMAT(1X,I4,1X,A8,F8.3)

      REGIONNUMBER = BASEX(IREG)
      IBELD4CROPX = IBELD4CROP-21
	WRITE(61,111) REGIONNUMBER,IBELD4CROPX
  111 FORMAT(1X,A8,I4,9X,I4,1X,A22,1X,I4,1X,A9,I4,F10.4)


	CALL OPENV(62,REGIONNUMBER//BXT(IBELD4CROPX), DIR, 'R')

    1	READ(62,111,END=2) REGION,IBELD4CROPX,KERTSALESIDEPIC,
     1FERTSALESNAMEEPIC,K,TIMINGN,I,FERTFRAC
	WRITE(61,111) REGION,IBELD4CROPX,KERTSALESIDEPIC,
     1FERTSALESNAMEEPIC,K,TIMINGN,I,FERTFRAC
      IF(I==5) GO TO 3
	GO TO 1
    3 FERTRATE=FERTFRAC*(FERTAPPGRID(IGRID12A,IBELD4CROP)/
     1FERTNFRAC(K))
C     FERTILIZER ADJUSTMENT TO REFLECT ONLY 60 PERCENT OF RAINFED HAY OR OTHER GRASS
C     IS LIKELY TO BE FERTILIZED
C      FERTMAXHAYGRASS = FERTAPPGRID(IGRID12A,IBELD4CROP)*.60
C
C      IF(IBELD4CROP==22.AND.XLOG12A.GT.-100) FERTRATE=FERTFRAC*
C     1(FERTAPPGRID(IGRID12A,IBELD4CROP)/FERTNFRAC(K))*0.6
C	IF(IBELD4CROP==26.AND.XLOG12A.GT.-100) FERTRATE=FERTFRAC*
C     1(FERTAPPGRID(IGRID12A,IBELD4CROP)/FERTNFRAC(K))*0.6
C     ADJUSTMENT FOR HAY AND OTHER GRASS
C	IF(IBELD4CROP==22)FERTRATE=FERTRATE*FERTADJHAYRF(ISFA)
	IF(IBELD4CROP==22)FERTRATE=FERTRATE

C	IF(IBELD4CROP==23)FERTRATE=FERTRATE*FERTADJHAYIR(ISFA)
	IF(IBELD4CROP==23)FERTRATE=FERTRATE

C       IF(IBELD4CROP==26)FERTRATE=FERTRATE*FERTADJOTHGRASS(ISFA)
	IF(IBELD4CROP==26)FERTRATE=FERTRATE
C


	IF(FERTRATE<0.01) FERTRATE = 0.1

C      IF(IBELD4CROP==22.OR.IBELD4CROP==26.AND.XLOG12A.GT.-100)
C     1WRITE(KW(14),122) EQUIPMENT(K,I),TRACTOR,IEPICCRP,K,
C     1FERTRATE,FERTMAXHAYGRASS,HUSCHED
C  122 FORMAT('  1','  1','  1',4I5,F8.1,8X,8X,8X,8X,F8.3,F8.3)
C      IF(IBELD4CROP/=22.AND.IBELD4CROP/=26)
      WRITE(KW(14),121) EQUIPMENT(K,I),TRACTOR,IEPICCRP,K,
     1FERTRATE,HUSCHED
  121 FORMAT('  1','  1','  1',4I5,F8.1,8X,8X,8X,8X,8X,F8.3)

      GO TO 1



    2 CLOSE(62)
	RETURN
      END

      SUBROUTINE FALLPLTSPRINGFERT(IEPICCRP,HUSCHED,XLOG12A, DIR)
      CHARACTER(*), INTENT  (IN) ::DIR
      CHARACTER*4 BXT
	CHARACTER*8 BASEX,REGIONNUMBER,REGION,FTNM2012
	CHARACTER*9 TIMINGN
	CHARACTER*22 FERTSALESNAMEEPIC

	INTEGER*8 EQUIPMENT
C
	INTEGER*2 IREG,FERTNUM,MANURETYPE,TRACTOR
      REAL*8 XLOG12A,YLAT12A,FERTNFRAC
      COMMON/BK2/KR(10),KW(30),KRF(10)
	COMMON/BK3/FERTNFRAC(200),FERTCHAR(10),FERTADJOTHGRASS(60),
	1FERTADJHAYRF(60),FERTADJHAYIR(60)
	COMMON/BK4/FERTNUM(200),EQUIPMENT(200,5),FERTAPPGRID(120000,70)
	COMMON/BK6/AXT(2),BXT(42),BASEX(10),FTNM2012(200)
      COMMON/BK7/IGRID12A,IBELD4CROP,IREG,TRACTOR,MANURETYPE(10)
	COMMON/BK8/IMONEND,IDAYEND,ISFA
C
      DATA BXT/'.C22','.C23','.C24','.C25','.C26','.C27','.C28','.C29',
     1'.C30','.C31','.C32','.C33','.C34','.C35','.C36','.C37','.C38',
     2'.C39','.C40','.C41','.C42','.C43','.C44','.C45','.C46','.C47',
     3'.C48','.C49','.C50','.C51','.C52','.C53','.C54','.C55','.C56',
     4'.C57','.C58','.C59','.C60','.C61','.C62','.C63'/BASEX/'REGION01',
	5'REGION02','REGION03','REGION04','REGION05','REGION06','REGION07',
	6'REGION08','REGION09','REGION10'/MANURETYPE/5,10,10,5,130,10,
     7130,5,2,5/
C	DO 392 IFRT=1,143
C	WRITE(61,393) IFRT,FTNM2012(IFRT),FERTNFRAC(IFRT)
C  392 CONTINUE
C  393 FORMAT(1X,I4,1X,A8,F8.3)

      REGIONNUMBER = BASEX(IREG)
      IBELD4CROPX = IBELD4CROP-21
	WRITE(61,111) REGIONNUMBER,IBELD4CROPX
  111 FORMAT(1X,A8,I4,9X,I4,1X,A22,1X,I4,1X,A9,I4,F10.4)


	CALL OPENV(62,REGIONNUMBER//BXT(IBELD4CROPX), DIR, 'R')

    1	READ(62,111,END=2) REGION,IBELD4CROPX,KERTSALESIDEPIC,
     1FERTSALESNAMEEPIC,K,TIMINGN,I,FERTFRAC
	WRITE(61,111) REGION,IBELD4CROPX,KERTSALESIDEPIC,
     1FERTSALESNAMEEPIC,K,TIMINGN,I,FERTFRAC
      IF(I==3) GO TO 3
	GO TO 1
    3 FERTRATE=FERTFRAC*(FERTAPPGRID(IGRID12A,IBELD4CROP)/
     1FERTNFRAC(K))
C     FERTILIZER ADJUSTMENT TO REFLECT ONLY 60 PERCENT OF RAINFED HAY OR OTHER GRASS
C     IS LIKELY TO BE FERTILIZED
C      FERTMAXHAYGRASS = FERTAPPGRID(IGRID12A,IBELD4CROP)*.60
C
C      IF(IBELD4CROP==22.AND.XLOG12A.GT.-100) FERTRATE=FERTFRAC*
C     1(FERTAPPGRID(IGRID12A,IBELD4CROP)/FERTNFRAC(K))*0.6
C	IF(IBELD4CROP==26.AND.XLOG12A.GT.-100) FERTRATE=FERTFRAC*
C     1(FERTAPPGRID(IGRID12A,IBELD4CROP)/FERTNFRAC(K))*0.6
C     ADJUSTMENT FOR HAY AND OTHER GRASS
C	IF(IBELD4CROP==22)FERTRATE=FERTRATE*FERTADJHAYRF(ISFA)
	IF(IBELD4CROP==22)FERTRATE=FERTRATE

C	IF(IBELD4CROP==23)FERTRATE=FERTRATE*FERTADJHAYIR(ISFA)
	IF(IBELD4CROP==23)FERTRATE=FERTRATE

C       IF(IBELD4CROP==26)FERTRATE=FERTRATE*FERTADJOTHGRASS(ISFA)
	IF(IBELD4CROP==26)FERTRATE=FERTRATE
C


	IF(FERTRATE<0.01) FERTRATE = 0.1

C      IF(IBELD4CROP==22.OR.IBELD4CROP==26.AND.XLOG12A.GT.-100)
C     1WRITE(KW(14),122) EQUIPMENT(K,I),TRACTOR,IEPICCRP,K,
C     1FERTRATE,FERTMAXHAYGRASS,HUSCHED
C  122 FORMAT('  1','  1','  1',4I5,F8.1,8X,8X,8X,8X,F8.3,F8.3)
C      IF(IBELD4CROP/=22.AND.IBELD4CROP/=26)
      WRITE(KW(14),121) EQUIPMENT(K,I),TRACTOR,IEPICCRP,K,
     1FERTRATE,HUSCHED
  121 FORMAT('  1','  1','  1',4I5,F8.1,8X,8X,8X,8X,8X,F8.3)

      GO TO 1



    2 CLOSE(62)
	RETURN
      END
      include "openv.f"
  
